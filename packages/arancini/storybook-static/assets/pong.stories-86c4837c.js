import{g as Nn,j as _e,F as $t,a as ut}from"./index.es-6456b573.js";import{U as zn,g as Vn,h as jn,i as Xn,j as Yn,k as Cr,l as Hn,m as Er,d as Zt,n as Jn,L as en,I as Kn,o as Qn,B as Zn,p as qn,D as _n,q as $n,r as tn,s as ea,t as ta,v as ra,V as Ar,w as Mr,x as na,y as aa,a as oa,b as ia,u as sa}from"./react-three-fiber.esm-dca5276d.js";import{r as Ye}from"./index-76fb7be0.js";import{S as la}from"./setup-1d901612.js";import{B as fa,P as ua}from"./Bounds-a89dda79.js";import{_ as ca}from"./extends-98964cd2.js";import"./_commonjsHelpers-de833af9.js";const da=u=>typeof u=="object"&&typeof u.then=="function",Xt=[];function ha(u,r,d=(f,t)=>f===t){if(u===r)return!0;if(!u||!r)return!1;const f=u.length;if(r.length!==f)return!1;for(let t=0;t<f;t++)if(!d(u[t],r[t]))return!1;return!0}function va(u,r=null,d=!1,f={}){r===null&&(r=[u]);for(const e of Xt)if(ha(r,e.keys,e.equal)){if(d)return;if(Object.prototype.hasOwnProperty.call(e,"error"))throw e.error;if(Object.prototype.hasOwnProperty.call(e,"response"))return f.lifespan&&f.lifespan>0&&(e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(e.remove,f.lifespan)),e.response;if(!d)throw e.promise}const t={keys:r,equal:f.equal,remove:()=>{const e=Xt.indexOf(t);e!==-1&&Xt.splice(e,1)},promise:(da(u)?u:u(...r)).then(e=>{t.response=e,f.lifespan&&f.lifespan>0&&(t.timeout=setTimeout(t.remove,f.lifespan))}).catch(e=>t.error=e)};if(Xt.push(t),!d)throw t.promise}const pa=(u,r,d)=>va(u,r,!1,d);function ga(){var u=Object.create(null);function r(t,e){var o=t.id,a=t.name,n=t.dependencies;n===void 0&&(n=[]);var i=t.init;i===void 0&&(i=function(){});var s=t.getTransferables;if(s===void 0&&(s=null),!u[o])try{n=n.map(function(c){return c&&c.isWorkerModule&&(r(c,function(h){if(h instanceof Error)throw h}),c=u[c.id].value),c}),i=f("<"+a+">.init",i),s&&(s=f("<"+a+">.getTransferables",s));var l=null;typeof i=="function"?l=i.apply(void 0,n):console.error("worker module init function failed to rehydrate"),u[o]={id:o,value:l,getTransferables:s},e(l)}catch(c){c&&c.noLog||console.error(c),e(c)}}function d(t,e){var o,a=t.id,n=t.args;(!u[a]||typeof u[a].value!="function")&&e(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var i=(o=u[a]).value.apply(o,n);i&&typeof i.then=="function"?i.then(s,function(l){return e(l instanceof Error?l:new Error(""+l))}):s(i)}catch(l){e(l)}function s(l){try{var c=u[a].getTransferables&&u[a].getTransferables(l);(!c||!Array.isArray(c)||!c.length)&&(c=void 0),e(l,c)}catch(h){console.error(h),e(h)}}}function f(t,e){var o=void 0;self.troikaDefine=function(n){return o=n};var a=URL.createObjectURL(new Blob(["/** "+t.replace(/\*/g,"")+` **/

troikaDefine(
`+e+`
)`],{type:"application/javascript"}));try{importScripts(a)}catch(n){console.error(n)}return URL.revokeObjectURL(a),delete self.troikaDefine,o}self.addEventListener("message",function(t){var e=t.data,o=e.messageId,a=e.action,n=e.data;try{a==="registerModule"&&r(n,function(i){i instanceof Error?postMessage({messageId:o,success:!1,error:i.message}):postMessage({messageId:o,success:!0,result:{isCallable:typeof i=="function"}})}),a==="callModule"&&d(n,function(i,s){i instanceof Error?postMessage({messageId:o,success:!1,error:i.message}):postMessage({messageId:o,success:!0,result:i},s||void 0)})}catch(i){postMessage({messageId:o,success:!1,error:i.stack})}})}function ma(u){var r=function(){for(var d=[],f=arguments.length;f--;)d[f]=arguments[f];return r._getInitResult().then(function(t){if(typeof t=="function")return t.apply(void 0,d);throw new Error("Worker module function was called but `init` did not return a callable function")})};return r._getInitResult=function(){var d=u.dependencies,f=u.init;d=Array.isArray(d)?d.map(function(e){return e&&e._getInitResult?e._getInitResult():e}):[];var t=Promise.all(d).then(function(e){return f.apply(null,e)});return r._getInitResult=function(){return t},t},r}var Sn=function(){var u=!1;if(typeof window<"u"&&typeof window.document<"u")try{var r=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));r.terminate(),u=!0}catch(d){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+d.message+"]")}return Sn=function(){return u},u},ya=0,ba=0,Ur=!1,xt=Object.create(null),kt=Object.create(null),Tr=Object.create(null);function Dt(u){if((!u||typeof u.init!="function")&&!Ur)throw new Error("requires `options.init` function");var r=u.dependencies,d=u.init,f=u.getTransferables,t=u.workerId;if(!Sn())return ma(u);t==null&&(t="#default");var e="workerModule"+ ++ya,o=u.name||e,a=null;r=r&&r.map(function(i){return typeof i=="function"&&!i.workerModuleData&&(Ur=!0,i=Dt({workerId:t,name:"<"+o+"> function dependency: "+i.name,init:`function(){return (
`+Kt(i)+`
)}`}),Ur=!1),i&&i.workerModuleData&&(i=i.workerModuleData),i});function n(){for(var i=[],s=arguments.length;s--;)i[s]=arguments[s];if(!a){a=rn(t,"registerModule",n.workerModuleData);var l=function(){a=null,kt[t].delete(l)};(kt[t]||(kt[t]=new Set)).add(l)}return a.then(function(c){var h=c.isCallable;if(h)return rn(t,"callModule",{id:e,args:i});throw new Error("Worker module function was called but `init` did not return a callable function")})}return n.workerModuleData={isWorkerModule:!0,id:e,name:o,dependencies:r,init:Kt(d),getTransferables:f&&Kt(f)},n}function Ua(u){kt[u]&&kt[u].forEach(function(r){r()}),xt[u]&&(xt[u].terminate(),delete xt[u])}function Kt(u){var r=u.toString();return!/^function/.test(r)&&/^\w+\s*\(/.test(r)&&(r="function "+r),r}function _a(u){var r=xt[u];if(!r){var d=Kt(ga);r=xt[u]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+u.replace(/\*/g,"")+` **/

;(`+d+")()"],{type:"application/javascript"}))),r.onmessage=function(f){var t=f.data,e=t.messageId,o=Tr[e];if(!o)throw new Error("WorkerModule response with empty or unknown messageId");delete Tr[e],o(t)}}return r}function rn(u,r,d){return new Promise(function(f,t){var e=++ba;Tr[e]=function(o){o.success?f(o.result):t(new Error("Error in worker "+r+" call: "+o.error))},_a(u).postMessage({messageId:e,action:r,data:d})})}function wn(){var u=function(r){function d(P,W,p,T,L,O,C,I){var F=1-C;I.x=F*F*P+2*F*C*p+C*C*L,I.y=F*F*W+2*F*C*T+C*C*O}function f(P,W,p,T,L,O,C,I,F,M){var z=1-F;M.x=z*z*z*P+3*z*z*F*p+3*z*F*F*L+F*F*F*C,M.y=z*z*z*W+3*z*z*F*T+3*z*F*F*O+F*F*F*I}function t(P,W){for(var p=/([MLQCZ])([^MLQCZ]*)/g,T,L,O,C,I;T=p.exec(P);){var F=T[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(M){return parseFloat(M)});switch(T[1]){case"M":C=L=F[0],I=O=F[1];break;case"L":(F[0]!==C||F[1]!==I)&&W("L",C,I,C=F[0],I=F[1]);break;case"Q":{W("Q",C,I,C=F[2],I=F[3],F[0],F[1]);break}case"C":{W("C",C,I,C=F[4],I=F[5],F[0],F[1],F[2],F[3]);break}case"Z":(C!==L||I!==O)&&W("L",C,I,L,O);break}}}function e(P,W,p){p===void 0&&(p=16);var T={x:0,y:0};t(P,function(L,O,C,I,F,M,z,q,V){switch(L){case"L":W(O,C,I,F);break;case"Q":{for(var A=O,he=C,ce=1;ce<p;ce++)d(O,C,M,z,I,F,ce/(p-1),T),W(A,he,T.x,T.y),A=T.x,he=T.y;break}case"C":{for(var X=O,$=C,le=1;le<p;le++)f(O,C,M,z,q,V,I,F,le/(p-1),T),W(X,$,T.x,T.y),X=T.x,$=T.y;break}}})}var o="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",a="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",n=new WeakMap,i={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function s(P,W){var p=P.getContext?P.getContext("webgl",i):P,T=n.get(p);if(!T){let z=function(X){var $=O[X];if(!$&&($=O[X]=p.getExtension(X),!$))throw new Error(X+" not supported");return $},q=function(X,$){var le=p.createShader($);return p.shaderSource(le,X),p.compileShader(le),le},V=function(X,$,le,B){if(!C[X]){var te={},H={},G=p.createProgram();p.attachShader(G,q($,p.VERTEX_SHADER)),p.attachShader(G,q(le,p.FRAGMENT_SHADER)),p.linkProgram(G),C[X]={program:G,transaction:function(Q){p.useProgram(G),Q({setUniform:function(J,me){for(var pe=[],ee=arguments.length-2;ee-- >0;)pe[ee]=arguments[ee+2];var ue=H[me]||(H[me]=p.getUniformLocation(G,me));p["uniform"+J].apply(p,[ue].concat(pe))},setAttribute:function(J,me,pe,ee,ue){var ge=te[J];ge||(ge=te[J]={buf:p.createBuffer(),loc:p.getAttribLocation(G,J),data:null}),p.bindBuffer(p.ARRAY_BUFFER,ge.buf),p.vertexAttribPointer(ge.loc,me,p.FLOAT,!1,0,0),p.enableVertexAttribArray(ge.loc),L?p.vertexAttribDivisor(ge.loc,ee):z("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(ge.loc,ee),ue!==ge.data&&(p.bufferData(p.ARRAY_BUFFER,ue,pe),ge.data=ue)}})}}}C[X].transaction(B)},A=function(X,$){F++;try{p.activeTexture(p.TEXTURE0+F);var le=I[X];le||(le=I[X]=p.createTexture(),p.bindTexture(p.TEXTURE_2D,le),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST)),p.bindTexture(p.TEXTURE_2D,le),$(le,F)}finally{F--}},he=function(X,$,le){var B=p.createFramebuffer();M.push(B),p.bindFramebuffer(p.FRAMEBUFFER,B),p.activeTexture(p.TEXTURE0+$),p.bindTexture(p.TEXTURE_2D,X),p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,X,0);try{le(B)}finally{p.deleteFramebuffer(B),p.bindFramebuffer(p.FRAMEBUFFER,M[--M.length-1]||null)}},ce=function(){O={},C={},I={},F=-1,M.length=0};var L=typeof WebGL2RenderingContext<"u"&&p instanceof WebGL2RenderingContext,O={},C={},I={},F=-1,M=[];p.canvas.addEventListener("webglcontextlost",function(X){ce(),X.preventDefault()},!1),n.set(p,T={gl:p,isWebGL2:L,getExtension:z,withProgram:V,withTexture:A,withTextureFramebuffer:he,handleContextLoss:ce})}W(T)}function l(P,W,p,T,L,O,C,I){C===void 0&&(C=15),I===void 0&&(I=null),s(P,function(F){var M=F.gl,z=F.withProgram,q=F.withTexture;q("copy",function(V,A){M.texImage2D(M.TEXTURE_2D,0,M.RGBA,L,O,0,M.RGBA,M.UNSIGNED_BYTE,W),z("copy",o,a,function(he){var ce=he.setUniform,X=he.setAttribute;X("aUV",2,M.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),ce("1i","image",A),M.bindFramebuffer(M.FRAMEBUFFER,I||null),M.disable(M.BLEND),M.colorMask(C&8,C&4,C&2,C&1),M.viewport(p,T,L,O),M.scissor(p,T,L,O),M.drawArrays(M.TRIANGLES,0,3)})})})}function c(P,W,p){var T=P.width,L=P.height;s(P,function(O){var C=O.gl,I=new Uint8Array(T*L*4);C.readPixels(0,0,T,L,C.RGBA,C.UNSIGNED_BYTE,I),P.width=W,P.height=p,l(C,I,0,0,T,L)})}var h=Object.freeze({__proto__:null,withWebGLContext:s,renderImageData:l,resizeWebGLCanvasWithoutClearing:c});function y(P,W,p,T,L,O){O===void 0&&(O=1);var C=new Uint8Array(P*W),I=T[2]-T[0],F=T[3]-T[1],M=[];e(p,function(X,$,le,B){M.push({x1:X,y1:$,x2:le,y2:B,minX:Math.min(X,le),minY:Math.min($,B),maxX:Math.max(X,le),maxY:Math.max($,B)})}),M.sort(function(X,$){return X.maxX-$.maxX});for(var z=0;z<P;z++)for(var q=0;q<W;q++){var V=he(T[0]+I*(z+.5)/P,T[1]+F*(q+.5)/W),A=Math.pow(1-Math.abs(V)/L,O)/2;V<0&&(A=1-A),A=Math.max(0,Math.min(255,Math.round(A*255))),C[q*P+z]=A}return C;function he(X,$){for(var le=1/0,B=1/0,te=M.length;te--;){var H=M[te];if(H.maxX+B<=X)break;if(X+B>H.minX&&$-B<H.maxY&&$+B>H.minY){var G=D(X,$,H.x1,H.y1,H.x2,H.y2);G<le&&(le=G,B=Math.sqrt(le))}}return ce(X,$)&&(B=-B),B}function ce(X,$){for(var le=0,B=M.length;B--;){var te=M[B];if(te.maxX<=X)break;var H=te.y1>$!=te.y2>$&&X<(te.x2-te.x1)*($-te.y1)/(te.y2-te.y1)+te.x1;H&&(le+=te.y1<te.y2?1:-1)}return le!==0}}function m(P,W,p,T,L,O,C,I,F,M){O===void 0&&(O=1),I===void 0&&(I=0),F===void 0&&(F=0),M===void 0&&(M=0),g(P,W,p,T,L,O,C,null,I,F,M)}function g(P,W,p,T,L,O,C,I,F,M,z){O===void 0&&(O=1),F===void 0&&(F=0),M===void 0&&(M=0),z===void 0&&(z=0);for(var q=y(P,W,p,T,L,O),V=new Uint8Array(q.length*4),A=0;A<q.length;A++)V[A*4+z]=q[A];l(C,V,F,M,P,W,1<<3-z,I)}function D(P,W,p,T,L,O){var C=L-p,I=O-T,F=C*C+I*I,M=F?Math.max(0,Math.min(1,((P-p)*C+(W-T)*I)/F)):0,z=P-(p+M*C),q=W-(T+M*I);return z*z+q*q}var v=Object.freeze({__proto__:null,generate:y,generateIntoCanvas:m,generateIntoFramebuffer:g}),_="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",k="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",U="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",w=new Float32Array([0,0,2,0,0,2]),x=null,S=!1,Y={},K=new WeakMap;function ne(P){if(!S&&!j(P))throw new Error("WebGL generation not supported")}function b(P,W,p,T,L,O,C){if(O===void 0&&(O=1),C===void 0&&(C=null),!C&&(C=x,!C)){var I=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!I)throw new Error("OffscreenCanvas or DOM canvas not supported");C=x=I.getContext("webgl",{depth:!1})}ne(C);var F=new Uint8Array(P*W*4);s(C,function(V){var A=V.gl,he=V.withTexture,ce=V.withTextureFramebuffer;he("readable",function(X,$){A.texImage2D(A.TEXTURE_2D,0,A.RGBA,P,W,0,A.RGBA,A.UNSIGNED_BYTE,null),ce(X,$,function(le){E(P,W,p,T,L,O,A,le,0,0,0),A.readPixels(0,0,P,W,A.RGBA,A.UNSIGNED_BYTE,F)})})});for(var M=new Uint8Array(P*W),z=0,q=0;z<F.length;z+=4)M[q++]=F[z];return M}function R(P,W,p,T,L,O,C,I,F,M){O===void 0&&(O=1),I===void 0&&(I=0),F===void 0&&(F=0),M===void 0&&(M=0),E(P,W,p,T,L,O,C,null,I,F,M)}function E(P,W,p,T,L,O,C,I,F,M,z){O===void 0&&(O=1),F===void 0&&(F=0),M===void 0&&(M=0),z===void 0&&(z=0),ne(C);var q=[];e(p,function(V,A,he,ce){q.push(V,A,he,ce)}),q=new Float32Array(q),s(C,function(V){var A=V.gl,he=V.isWebGL2,ce=V.getExtension,X=V.withProgram,$=V.withTexture,le=V.withTextureFramebuffer,B=V.handleContextLoss;if($("rawDistances",function(te,H){(P!==te._lastWidth||W!==te._lastHeight)&&A.texImage2D(A.TEXTURE_2D,0,A.RGBA,te._lastWidth=P,te._lastHeight=W,0,A.RGBA,A.UNSIGNED_BYTE,null),X("main",_,k,function(G){var ae=G.setAttribute,Q=G.setUniform,re=!he&&ce("ANGLE_instanced_arrays"),J=!he&&ce("EXT_blend_minmax");ae("aUV",2,A.STATIC_DRAW,0,w),ae("aLineSegment",4,A.DYNAMIC_DRAW,1,q),Q.apply(void 0,["4f","uGlyphBounds"].concat(T)),Q("1f","uMaxDistance",L),Q("1f","uExponent",O),le(te,H,function(me){A.enable(A.BLEND),A.colorMask(!0,!0,!0,!0),A.viewport(0,0,P,W),A.scissor(0,0,P,W),A.blendFunc(A.ONE,A.ONE),A.blendEquationSeparate(A.FUNC_ADD,he?A.MAX:J.MAX_EXT),A.clear(A.COLOR_BUFFER_BIT),he?A.drawArraysInstanced(A.TRIANGLES,0,3,q.length/4):re.drawArraysInstancedANGLE(A.TRIANGLES,0,3,q.length/4)})}),X("post",o,U,function(G){G.setAttribute("aUV",2,A.STATIC_DRAW,0,w),G.setUniform("1i","tex",H),A.bindFramebuffer(A.FRAMEBUFFER,I),A.disable(A.BLEND),A.colorMask(z===0,z===1,z===2,z===3),A.viewport(F,M,P,W),A.scissor(F,M,P,W),A.drawArrays(A.TRIANGLES,0,3)})}),A.isContextLost())throw B(),new Error("webgl context lost")})}function j(P){var W=!P||P===x?Y:P.canvas||P,p=K.get(W);if(p===void 0){S=!0;var T=null;try{var L=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],O=b(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,P);p=O&&L.length===O.length&&O.every(function(C,I){return C===L[I]}),p||(T="bad trial run results",console.info(L,O))}catch(C){p=!1,T=C.message}T&&console.warn("WebGL SDF generation not supported:",T),S=!1,K.set(W,p)}return p}var N=Object.freeze({__proto__:null,generate:b,generateIntoCanvas:R,generateIntoFramebuffer:E,isSupported:j});function se(P,W,p,T,L,O){L===void 0&&(L=Math.max(T[2]-T[0],T[3]-T[1])/2),O===void 0&&(O=1);try{return b.apply(N,arguments)}catch(C){return console.info("WebGL SDF generation failed, falling back to JS",C),y.apply(v,arguments)}}function ie(P,W,p,T,L,O,C,I,F,M){L===void 0&&(L=Math.max(T[2]-T[0],T[3]-T[1])/2),O===void 0&&(O=1),I===void 0&&(I=0),F===void 0&&(F=0),M===void 0&&(M=0);try{return R.apply(N,arguments)}catch(z){return console.info("WebGL SDF generation failed, falling back to JS",z),m.apply(v,arguments)}}return r.forEachPathCommand=t,r.generate=se,r.generateIntoCanvas=ie,r.javascript=v,r.pathToLineSegments=e,r.webgl=N,r.webglUtils=h,Object.defineProperty(r,"__esModule",{value:!0}),r}({});return u}function Sa(){var u=function(r){var d={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},f={},t={};f.L=1,t[1]="L",Object.keys(d).forEach(function(B,te){f[B]=1<<te+1,t[f[B]]=B}),Object.freeze(f);var e=f.LRI|f.RLI|f.FSI,o=f.L|f.R|f.AL,a=f.B|f.S|f.WS|f.ON|f.FSI|f.LRI|f.RLI|f.PDI,n=f.BN|f.RLE|f.LRE|f.RLO|f.LRO|f.PDF,i=f.S|f.WS|f.B|e|f.PDI|n,s=null;function l(){if(!s){s=new Map;var B=function(H){if(d.hasOwnProperty(H)){var G=0;d[H].split(",").forEach(function(ae){var Q=ae.split("+"),re=Q[0],J=Q[1];re=parseInt(re,36),J=J?parseInt(J,36):0,s.set(G+=re,f[H]);for(var me=0;me<J;me++)s.set(++G,f[H])})}};for(var te in d)B(te)}}function c(B){return l(),s.get(B.codePointAt(0))||f.L}function h(B){return t[c(B)]}var y={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function m(B,te){var H=36,G=0,ae=new Map,Q=te&&new Map,re;return B.split(",").forEach(function J(me){if(me.indexOf("+")!==-1)for(var pe=+me;pe--;)J(re);else{re=me;var ee=me.split(">"),ue=ee[0],ge=ee[1];ue=String.fromCodePoint(G+=parseInt(ue,H)),ge=String.fromCodePoint(G+=parseInt(ge,H)),ae.set(ue,ge),te&&Q.set(ge,ue)}}),{map:ae,reverseMap:Q}}var g,D,v;function _(){if(!g){var B=m(y.pairs,!0),te=B.map,H=B.reverseMap;g=te,D=H,v=m(y.canonical,!1).map}}function k(B){return _(),g.get(B)||null}function U(B){return _(),D.get(B)||null}function w(B){return _(),v.get(B)||null}var x=f.L,S=f.R,Y=f.EN,K=f.ES,ne=f.ET,b=f.AN,R=f.CS,E=f.B,j=f.S,N=f.ON,se=f.BN,ie=f.NSM,P=f.AL,W=f.LRO,p=f.RLO,T=f.LRE,L=f.RLE,O=f.PDF,C=f.LRI,I=f.RLI,F=f.FSI,M=f.PDI;function z(B,te){for(var H=125,G=new Uint32Array(B.length),ae=0;ae<B.length;ae++)G[ae]=c(B[ae]);var Q=new Map;function re(Pe,Xe){var Le=G[Pe];G[Pe]=Xe,Q.set(Le,Q.get(Le)-1),Le&a&&Q.set(a,Q.get(a)-1),Q.set(Xe,(Q.get(Xe)||0)+1),Xe&a&&Q.set(a,(Q.get(a)||0)+1)}for(var J=new Uint8Array(B.length),me=new Map,pe=[],ee=null,ue=0;ue<B.length;ue++)ee||pe.push(ee={start:ue,end:B.length-1,level:te==="rtl"?1:te==="ltr"?0:qr(ue,!1)}),G[ue]&E&&(ee.end=ue,ee=null);for(var ge=L|T|p|W|e|M|O|E,Fe=function(Pe){return Pe+(Pe&1?1:2)},fe=function(Pe){return Pe+(Pe&1?2:1)},Se=0;Se<pe.length;Se++){ee=pe[Se];var ve=[{_level:ee.level,_override:0,_isolate:0}],oe=void 0,ye=0,Ue=0,De=0;Q.clear();for(var de=ee.start;de<=ee.end;de++){var we=G[de];if(oe=ve[ve.length-1],Q.set(we,(Q.get(we)||0)+1),we&a&&Q.set(a,(Q.get(a)||0)+1),we&ge)if(we&(L|T)){J[de]=oe._level;var Ge=(we===L?fe:Fe)(oe._level);Ge<=H&&!ye&&!Ue?ve.push({_level:Ge,_override:0,_isolate:0}):ye||Ue++}else if(we&(p|W)){J[de]=oe._level;var He=(we===p?fe:Fe)(oe._level);He<=H&&!ye&&!Ue?ve.push({_level:He,_override:we&p?S:x,_isolate:0}):ye||Ue++}else if(we&e){we&F&&(we=qr(de+1,!0)===1?I:C),J[de]=oe._level,oe._override&&re(de,oe._override);var qe=(we===I?fe:Fe)(oe._level);qe<=H&&ye===0&&Ue===0?(De++,ve.push({_level:qe,_override:0,_isolate:1,_isolInitIndex:de})):ye++}else if(we&M){if(ye>0)ye--;else if(De>0){for(Ue=0;!ve[ve.length-1]._isolate;)ve.pop();var Je=ve[ve.length-1]._isolInitIndex;Je!=null&&(me.set(Je,de),me.set(de,Je)),ve.pop(),De--}oe=ve[ve.length-1],J[de]=oe._level,oe._override&&re(de,oe._override)}else we&O?(ye===0&&(Ue>0?Ue--:!oe._isolate&&ve.length>1&&(ve.pop(),oe=ve[ve.length-1])),J[de]=oe._level):we&E&&(J[de]=ee.level);else J[de]=oe._level,oe._override&&we!==se&&re(de,oe._override)}for(var We=[],Be=null,Te=ee.start;Te<=ee.end;Te++){var ct=G[Te];if(!(ct&n)){var ke=J[Te],xe=ct&e,ze=ct===M;Be&&ke===Be._level?(Be._end=Te,Be._endsWithIsolInit=xe):We.push(Be={_start:Te,_end:Te,_level:ke,_startsWithPDI:ze,_endsWithIsolInit:xe})}}for(var Re=[],be=0;be<We.length;be++){var Ee=We[be];if(!Ee._startsWithPDI||Ee._startsWithPDI&&!me.has(Ee._start)){for(var Ne=[Be=Ee],Me=void 0;Be&&Be._endsWithIsolInit&&(Me=me.get(Be._end))!=null;)for(var Ce=be+1;Ce<We.length;Ce++)if(We[Ce]._start===Me){Ne.push(Be=We[Ce]);break}for(var Oe=[],Ke=0;Ke<Ne.length;Ke++)for(var Ve=Ne[Ke],$e=Ve._start;$e<=Ve._end;$e++)Oe.push($e);for(var On=J[Oe[0]],Or=ee.level,Ct=Oe[0]-1;Ct>=0;Ct--)if(!(G[Ct]&n)){Or=J[Ct];break}var rr=Oe[Oe.length-1],Ln=J[rr],Lr=ee.level;if(!(G[rr]&e)){for(var Et=rr+1;Et<=ee.end;Et++)if(!(G[Et]&n)){Lr=J[Et];break}}Re.push({_seqIndices:Oe,_sosType:Math.max(Or,On)%2?S:x,_eosType:Math.max(Lr,Ln)%2?S:x})}}for(var nr=0;nr<Re.length;nr++){var ar=Re[nr],Z=ar._seqIndices,dt=ar._sosType,Bn=ar._eosType;if(Q.get(ie))for(var At=0;At<Z.length;At++){var Br=Z[At];if(G[Br]&ie){for(var or=dt,Mt=At-1;Mt>=0;Mt--)if(!(G[Z[Mt]]&n)){or=G[Z[Mt]];break}re(Br,or&(e|M)?N:or)}}if(Q.get(Y))for(var Pt=0;Pt<Z.length;Pt++){var Rr=Z[Pt];if(G[Rr]&Y)for(var Gt=Pt-1;Gt>=-1;Gt--){var Ir=Gt===-1?dt:G[Z[Gt]];if(Ir&o){Ir===P&&re(Rr,b);break}}}if(Q.get(P))for(var ir=0;ir<Z.length;ir++){var Wr=Z[ir];G[Wr]&P&&re(Wr,S)}if(Q.get(K)||Q.get(R))for(var ht=1;ht<Z.length-1;ht++){var sr=Z[ht];if(G[sr]&(K|R)){for(var nt=0,lr=0,fr=ht-1;fr>=0&&(nt=G[Z[fr]],!!(nt&n));fr--);for(var ur=ht+1;ur<Z.length&&(lr=G[Z[ur]],!!(lr&n));ur++);nt===lr&&(G[sr]===K?nt===Y:nt&(Y|b))&&re(sr,nt)}}if(Q.get(Y))for(var vt=0;vt<Z.length;vt++){var Rn=Z[vt];if(G[Rn]&Y){for(var Ot=vt-1;Ot>=0&&G[Z[Ot]]&(ne|n);Ot--)re(Z[Ot],Y);for(var Lt=vt+1;Lt<Z.length&&G[Z[Lt]]&(ne|n);Lt++)re(Z[Lt],Y)}}if(Q.get(ne)||Q.get(K)||Q.get(R))for(var pt=0;pt<Z.length;pt++){var Nr=Z[pt];if(G[Nr]&(ne|K|R)){re(Nr,N);for(var Bt=pt-1;Bt>=0&&G[Z[Bt]]&n;Bt--)re(Z[Bt],N);for(var Rt=pt+1;Rt<Z.length&&G[Z[Rt]]&n;Rt++)re(Z[Rt],N)}}if(Q.get(Y))for(var cr=0,zr=dt;cr<Z.length;cr++){var Vr=Z[cr],dr=G[Vr];dr&Y?zr===x&&re(Vr,x):dr&o&&(zr=dr)}if(Q.get(a)){var gt=S|Y|b,jr=gt|x,It=[];{for(var at=[],ot=0;ot<Z.length;ot++)if(G[Z[ot]]&a){var mt=B[Z[ot]],Xr=void 0;if(k(mt)!==null)if(at.length<63)at.push({char:mt,seqIndex:ot});else break;else if((Xr=U(mt))!==null)for(var yt=at.length-1;yt>=0;yt--){var hr=at[yt].char;if(hr===Xr||hr===U(w(mt))||k(w(hr))===mt){It.push([at[yt].seqIndex,ot]),at.length=yt;break}}}It.sort(function(Pe,Xe){return Pe[0]-Xe[0]})}for(var vr=0;vr<It.length;vr++){for(var Yr=It[vr],bt=Yr[0],Wt=Yr[1],Hr=!1,je=0,pr=bt+1;pr<Wt;pr++){var gr=Z[pr];if(G[gr]&jr){Hr=!0;var Jr=G[gr]&gt?S:x;if(Jr===it(gr)){je=Jr;break}}}if(Hr&&!je){je=dt;for(var mr=bt-1;mr>=0;mr--){var Nt=Z[mr];if(G[Nt]&jr){var Kr=G[Nt]&gt?S:x;Kr!==it(Nt)?je=Kr:je=it(Nt);break}}}if(je){if(G[Z[bt]]=G[Z[Wt]]=je,je!==it(Z[bt])){for(var Ut=bt+1;Ut<Z.length;Ut++)if(!(G[Z[Ut]]&n)){c(B[Z[Ut]])&ie&&(G[Z[Ut]]=je);break}}if(je!==it(Z[Wt])){for(var _t=Wt+1;_t<Z.length;_t++)if(!(G[Z[_t]]&n)){c(B[Z[_t]])&ie&&(G[Z[_t]]=je);break}}}}for(var Qe=0;Qe<Z.length;Qe++)if(G[Z[Qe]]&a){for(var Qr=Qe,yr=Qe,br=dt,St=Qe-1;St>=0;St--)if(G[Z[St]]&n)Qr=St;else{br=G[Z[St]]&gt?S:x;break}for(var Zr=Bn,wt=Qe+1;wt<Z.length;wt++)if(G[Z[wt]]&(a|n))yr=wt;else{Zr=G[Z[wt]]&gt?S:x;break}for(var zt=Qr;zt<=yr;zt++)G[Z[zt]]=br===Zr?br:it(Z[zt]);Qe=yr}}}for(var Ie=ee.start;Ie<=ee.end;Ie++){var In=J[Ie],Vt=G[Ie];if(In&1?Vt&(x|Y|b)&&J[Ie]++:Vt&S?J[Ie]++:Vt&(b|Y)&&(J[Ie]+=2),Vt&n&&(J[Ie]=Ie===0?ee.level:J[Ie-1]),Ie===ee.end||c(B[Ie])&(j|E))for(var jt=Ie;jt>=0&&c(B[jt])&i;jt--)J[jt]=ee.level}}return{levels:J,paragraphs:pe};function qr(Pe,Xe){for(var Le=Pe;Le<B.length;Le++){var Ze=G[Le];if(Ze&(S|P))return 1;if(Ze&(E|x)||Xe&&Ze===M)return 0;if(Ze&e){var $r=Wn(Le);Le=$r===-1?B.length:$r}}return 0}function Wn(Pe){for(var Xe=1,Le=Pe+1;Le<B.length;Le++){var Ze=G[Le];if(Ze&E)break;if(Ze&M){if(--Xe===0)return Le}else Ze&e&&Xe++}return-1}function it(Pe){return J[Pe]&1?S:x}}var q="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",V;function A(){if(!V){var B=m(q,!0),te=B.map,H=B.reverseMap;H.forEach(function(G,ae){te.set(ae,G)}),V=te}}function he(B){return A(),V.get(B)||null}function ce(B,te,H,G){var ae=B.length;H=Math.max(0,H==null?0:+H),G=Math.min(ae-1,G==null?ae-1:+G);for(var Q=new Map,re=H;re<=G;re++)if(te[re]&1){var J=he(B[re]);J!==null&&Q.set(re,J)}return Q}function X(B,te,H,G){var ae=B.length;H=Math.max(0,H==null?0:+H),G=Math.min(ae-1,G==null?ae-1:+G);var Q=[];return te.paragraphs.forEach(function(re){var J=Math.max(H,re.start),me=Math.min(G,re.end);if(J<me){for(var pe=te.levels.slice(J,me+1),ee=me;ee>=J&&c(B[ee])&i;ee--)pe[ee]=re.level;for(var ue=re.level,ge=1/0,Fe=0;Fe<pe.length;Fe++){var fe=pe[Fe];fe>ue&&(ue=fe),fe<ge&&(ge=fe|1)}for(var Se=ue;Se>=ge;Se--)for(var ve=0;ve<pe.length;ve++)if(pe[ve]>=Se){for(var oe=ve;ve+1<pe.length&&pe[ve+1]>=Se;)ve++;ve>oe&&Q.push([oe+H,ve+H])}}}),Q}function $(B,te,H,G){var ae=le(B,te,H,G),Q=[].concat(B);return ae.forEach(function(re,J){Q[J]=(te.levels[re]&1?he(B[re]):null)||B[re]}),Q.join("")}function le(B,te,H,G){for(var ae=X(B,te,H,G),Q=[],re=0;re<B.length;re++)Q[re]=re;return ae.forEach(function(J){for(var me=J[0],pe=J[1],ee=Q.slice(me,pe+1),ue=ee.length;ue--;)Q[pe-ue]=ee[ue]}),Q}return r.closingToOpeningBracket=U,r.getBidiCharType=c,r.getBidiCharTypeName=h,r.getCanonicalBracket=w,r.getEmbeddingLevels=z,r.getMirroredCharacter=he,r.getMirroredCharactersMap=ce,r.getReorderSegments=X,r.getReorderedIndices=le,r.getReorderedString=$,r.openingToClosingBracket=k,Object.defineProperty(r,"__esModule",{value:!0}),r}({});return u}const Tn=/\bvoid\s+main\s*\(\s*\)\s*{/g;function xr(u){const r=/^[ \t]*#include +<([\w\d./]+)>/gm;function d(f,t){let e=Yn[t];return e?xr(e):f}return u.replace(r,d)}const Ae=[];for(let u=0;u<256;u++)Ae[u]=(u<16?"0":"")+u.toString(16);function wa(){const u=Math.random()*4294967295|0,r=Math.random()*4294967295|0,d=Math.random()*4294967295|0,f=Math.random()*4294967295|0;return(Ae[u&255]+Ae[u>>8&255]+Ae[u>>16&255]+Ae[u>>24&255]+"-"+Ae[r&255]+Ae[r>>8&255]+"-"+Ae[r>>16&15|64]+Ae[r>>24&255]+"-"+Ae[d&63|128]+Ae[d>>8&255]+"-"+Ae[d>>16&255]+Ae[d>>24&255]+Ae[f&255]+Ae[f>>8&255]+Ae[f>>16&255]+Ae[f>>24&255]).toUpperCase()}const et=Object.assign||function(){let u=arguments[0];for(let r=1,d=arguments.length;r<d;r++){let f=arguments[r];if(f)for(let t in f)Object.prototype.hasOwnProperty.call(f,t)&&(u[t]=f[t])}return u},Ta=Date.now(),nn=new WeakMap,an=new Map;let xa=1e10;function kr(u,r){const d=Ca(r);let f=nn.get(u);if(f||nn.set(u,f=Object.create(null)),f[d])return new f[d];const t=`_onBeforeCompile${d}`,e=function(i,s){u.onBeforeCompile.call(this,i,s);const l=this.customProgramCacheKey()+"|"+i.vertexShader+"|"+i.fragmentShader;let c=an[l];if(!c){const h=ka(this,i,r,d);c=an[l]=h}i.vertexShader=c.vertexShader,i.fragmentShader=c.fragmentShader,et(i.uniforms,this.uniforms),r.timeUniform&&(i.uniforms[r.timeUniform]={get value(){return Date.now()-Ta}}),this[t]&&this[t](i)},o=function(){return a(r.chained?u:u.clone())},a=function(i){const s=Object.create(i,n);return Object.defineProperty(s,"baseMaterial",{value:u}),Object.defineProperty(s,"id",{value:xa++}),s.uuid=wa(),s.uniforms=et({},i.uniforms,r.uniforms),s.defines=et({},i.defines,r.defines),s.defines[`TROIKA_DERIVED_MATERIAL_${d}`]="",s.extensions=et({},i.extensions,r.extensions),s._listeners=void 0,s},n={constructor:{value:o},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return u.customProgramCacheKey()+"|"+d}},onBeforeCompile:{get(){return e},set(i){this[t]=i}},copy:{writable:!0,configurable:!0,value:function(i){return u.copy.call(this,i),!u.isShaderMaterial&&!u.isDerivedMaterial&&(et(this.extensions,i.extensions),et(this.defines,i.defines),et(this.uniforms,zn.clone(i.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const i=new u.constructor;return a(i).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let i=this._depthMaterial;return i||(i=this._depthMaterial=kr(u.isDerivedMaterial?u.getDepthMaterial():new Vn({depthPacking:jn}),r),i.defines.IS_DEPTH_MATERIAL="",i.uniforms=this.uniforms),i}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let i=this._distanceMaterial;return i||(i=this._distanceMaterial=kr(u.isDerivedMaterial?u.getDistanceMaterial():new Xn,r),i.defines.IS_DISTANCE_MATERIAL="",i.uniforms=this.uniforms),i}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:i,_distanceMaterial:s}=this;i&&i.dispose(),s&&s.dispose(),u.dispose.call(this)}}};return f[d]=o,new o}function ka(u,{vertexShader:r,fragmentShader:d},f,t){let{vertexDefs:e,vertexMainIntro:o,vertexMainOutro:a,vertexTransform:n,fragmentDefs:i,fragmentMainIntro:s,fragmentMainOutro:l,fragmentColorTransform:c,customRewriter:h,timeUniform:y}=f;if(e=e||"",o=o||"",a=a||"",i=i||"",s=s||"",l=l||"",(n||h)&&(r=xr(r)),(c||h)&&(d=d.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),d=xr(d)),h){let m=h({vertexShader:r,fragmentShader:d});r=m.vertexShader,d=m.fragmentShader}if(c){let m=[];d=d.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,g=>(m.push(g),"")),l=`${c}
${m.join(`
`)}
${l}`}if(y){const m=`
uniform float ${y};
`;e=m+e,i=m+i}return n&&(r=`vec3 troika_position_${t};
vec3 troika_normal_${t};
vec2 troika_uv_${t};
${r}
`,e=`${e}
void troikaVertexTransform${t}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${n}
}
`,o=`
troika_position_${t} = vec3(position);
troika_normal_${t} = vec3(normal);
troika_uv_${t} = vec2(uv);
troikaVertexTransform${t}(troika_position_${t}, troika_normal_${t}, troika_uv_${t});
${o}
`,r=r.replace(/\b(position|normal|uv)\b/g,(m,g,D,v)=>/\battribute\s+vec[23]\s+$/.test(v.substr(0,D))?g:`troika_${g}_${t}`),u.map&&u.map.channel>0||(r=r.replace(/\bMAP_UV\b/g,`troika_uv_${t}`))),r=on(r,t,e,o,a),d=on(d,t,i,s,l),{vertexShader:r,fragmentShader:d}}function on(u,r,d,f,t){return(f||t||d)&&(u=u.replace(Tn,`
${d}
void troikaOrigMain${r}() {`),u+=`
void main() {
  ${f}
  troikaOrigMain${r}();
  ${t}
}`),u}function Fa(u,r){return u==="uniforms"?void 0:typeof r=="function"?r.toString():r}let Da=0;const sn=new Map;function Ca(u){const r=JSON.stringify(u,Fa);let d=sn.get(r);return d==null&&sn.set(r,d=++Da),d}function Ea(u,r,d){const{defaultFontURL:f}=d,t=Object.create(null),e=1/0,o=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,a="[^\\S\\u00A0]",n=new RegExp(`${a}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function i(v,_){function k(){const U=w=>{console.error(`Failure loading font ${v}${v===f?"":"; trying fallback"}`,w),v!==f&&(v=f,k())};try{const w=new XMLHttpRequest;w.open("get",v,!0),w.responseType="arraybuffer",w.onload=function(){if(w.status>=400)U(new Error(w.statusText));else if(w.status>0)try{const x=u(w.response);_(x)}catch(x){U(x)}},w.onerror=U,w.send()}catch(w){U(w)}}k()}function s(v,_){v||(v=f);let k=t[v];k?k.pending?k.pending.push(_):_(k):(t[v]={pending:[_]},i(v,U=>{let w=t[v].pending;t[v]=U,w.forEach(x=>x(U))}))}function l({text:v="",font:_=f,sdfGlyphSize:k=64,fontSize:U=1,letterSpacing:w=0,lineHeight:x="normal",maxWidth:S=e,direction:Y,textAlign:K="left",textIndent:ne=0,whiteSpace:b="normal",overflowWrap:R="normal",anchorX:E=0,anchorY:j=0,includeCaretPositions:N=!1,chunkedBoundsSize:se=8192,colorRanges:ie=null},P,W=!1){const p=m(),T={fontLoad:0,typesetting:0};v.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),v=v.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),U=+U,w=+w,S=+S,x=x||"normal",ne=+ne,s(_,L=>{const O=isFinite(S);let C=null,I=null,F=null,M=null,z=null,q=null,V=null,A=0,he=0,ce=b!=="nowrap";const{ascender:X,descender:$,unitsPerEm:le,lineGap:B,capHeight:te,xHeight:H}=L;T.fontLoad=m()-p;const G=m(),ae=U/le;x==="normal"&&(x=(X-$+B)/le),x=x*U;const Q=(x-(X-$)*ae)/2,re=-(X*ae+Q),J=Math.min(x,(X-$)*ae),me=(X+$)/2*ae-J/2;let pe=ne,ee=new g;const ue=[ee];L.forEachGlyph(v,U,w,(fe,Se,ve)=>{const oe=v.charAt(ve),ye=fe.advanceWidth*ae,Ue=ee.count;let De;if("isEmpty"in fe||(fe.isWhitespace=!!oe&&new RegExp(a).test(oe),fe.canBreakAfter=!!oe&&n.test(oe),fe.isEmpty=fe.xMin===fe.xMax||fe.yMin===fe.yMax||o.test(oe)),!fe.isWhitespace&&!fe.isEmpty&&he++,ce&&O&&!fe.isWhitespace&&Se+ye+pe>S&&Ue){if(ee.glyphAt(Ue-1).glyphObj.canBreakAfter)De=new g,pe=-Se;else for(let we=Ue;we--;)if(we===0&&R==="break-word"){De=new g,pe=-Se;break}else if(ee.glyphAt(we).glyphObj.canBreakAfter){De=ee.splitAt(we+1);const Ge=De.glyphAt(0).x;pe-=Ge;for(let He=De.count;He--;)De.glyphAt(He).x-=Ge;break}De&&(ee.isSoftWrapped=!0,ee=De,ue.push(ee),A=S)}let de=ee.glyphAt(ee.count);de.glyphObj=fe,de.x=Se+pe,de.width=ye,de.charIndex=ve,oe===`
`&&(ee=new g,ue.push(ee),pe=-(Se+ye+w*U)+ne)}),ue.forEach(fe=>{for(let Se=fe.count;Se--;){let{glyphObj:ve,x:oe,width:ye}=fe.glyphAt(Se);if(!ve.isWhitespace){fe.width=oe+ye,fe.width>A&&(A=fe.width);return}}});let ge=0,Fe=0;if(E&&(typeof E=="number"?ge=-E:typeof E=="string"&&(ge=-A*(E==="left"?0:E==="center"?.5:E==="right"?1:h(E)))),j){if(typeof j=="number")Fe=-j;else if(typeof j=="string"){let fe=ue.length*x;Fe=j==="top"?0:j==="top-baseline"?-re:j==="top-cap"?-re-te*ae:j==="top-ex"?-re-H*ae:j==="middle"?fe/2:j==="bottom"?fe:j==="bottom-baseline"?fe-Q+$*ae:h(j)*fe}}if(!W){const fe=r.getEmbeddingLevels(v,Y);C=new Uint16Array(he),I=new Float32Array(he*2),F={},q=[e,e,-e,-e],V=[];let Se=re;N&&(z=new Float32Array(v.length*3)),ie&&(M=new Uint8Array(he*3));let ve=0,oe=-1,ye=-1,Ue,De;if(ue.forEach((de,we)=>{let{count:Ge,width:He}=de;if(Ge>0){let qe=0;for(let ke=Ge;ke--&&de.glyphAt(ke).glyphObj.isWhitespace;)qe++;let Je=0,We=0;if(K==="center")Je=(A-He)/2;else if(K==="right")Je=A-He;else if(K==="justify"&&de.isSoftWrapped){let ke=0;for(let xe=Ge-qe;xe--;)de.glyphAt(xe).glyphObj.isWhitespace&&ke++;We=(A-He)/ke}if(We||Je){let ke=0;for(let xe=0;xe<Ge;xe++){let ze=de.glyphAt(xe);const Re=ze.glyphObj;ze.x+=Je+ke,We!==0&&Re.isWhitespace&&xe<Ge-qe&&(ke+=We,ze.width+=We)}}const Be=r.getReorderSegments(v,fe,de.glyphAt(0).charIndex,de.glyphAt(de.count-1).charIndex);for(let ke=0;ke<Be.length;ke++){const[xe,ze]=Be[ke];let Re=1/0,be=-1/0;for(let Ee=0;Ee<Ge;Ee++)if(de.glyphAt(Ee).charIndex>=xe){let Ne=Ee,Me=Ee;for(;Me<Ge;Me++){let Ce=de.glyphAt(Me);if(Ce.charIndex>ze)break;Me<Ge-qe&&(Re=Math.min(Re,Ce.x),be=Math.max(be,Ce.x+Ce.width))}for(let Ce=Ne;Ce<Me;Ce++){const Oe=de.glyphAt(Ce);Oe.x=be-(Oe.x+Oe.width-Re)}break}}let Te;const ct=ke=>Te=ke;for(let ke=0;ke<Ge;ke++){let xe=de.glyphAt(ke);Te=xe.glyphObj;const ze=Te.index,Re=fe.levels[xe.charIndex]&1;if(Re){const be=r.getMirroredCharacter(v[xe.charIndex]);be&&L.forEachGlyph(be,0,0,ct)}if(N){const{charIndex:be}=xe,Ee=xe.x+ge,Ne=xe.x+xe.width+ge;z[be*3]=Re?Ne:Ee,z[be*3+1]=Re?Ee:Ne,z[be*3+2]=Se+me+Fe;const Me=be-oe;Me>1&&y(z,oe,Me),oe=be}if(ie){const{charIndex:be}=xe;for(;be>ye;)ye++,ie.hasOwnProperty(ye)&&(De=ie[ye])}if(!Te.isWhitespace&&!Te.isEmpty){const be=ve++;F[ze]||(F[ze]={path:Te.path,pathBounds:[Te.xMin,Te.yMin,Te.xMax,Te.yMax]});const Ee=xe.x+ge,Ne=Se+Fe;I[be*2]=Ee,I[be*2+1]=Ne;const Me=Ee+Te.xMin*ae,Ce=Ne+Te.yMin*ae,Oe=Ee+Te.xMax*ae,Ke=Ne+Te.yMax*ae;Me<q[0]&&(q[0]=Me),Ce<q[1]&&(q[1]=Ce),Oe>q[2]&&(q[2]=Oe),Ke>q[3]&&(q[3]=Ke),be%se===0&&(Ue={start:be,end:be,rect:[e,e,-e,-e]},V.push(Ue)),Ue.end++;const Ve=Ue.rect;if(Me<Ve[0]&&(Ve[0]=Me),Ce<Ve[1]&&(Ve[1]=Ce),Oe>Ve[2]&&(Ve[2]=Oe),Ke>Ve[3]&&(Ve[3]=Ke),C[be]=ze,ie){const $e=be*3;M[$e]=De>>16&255,M[$e+1]=De>>8&255,M[$e+2]=De&255}}}}Se-=x}),z){const de=v.length-oe;de>1&&y(z,oe,de)}}T.typesetting=m()-G,P({glyphIds:C,glyphPositions:I,glyphData:F,caretPositions:z,caretHeight:J,glyphColors:M,chunkedBounds:V,fontSize:U,unitsPerEm:le,ascender:X*ae,descender:$*ae,capHeight:te*ae,xHeight:H*ae,lineHeight:x,topBaseline:re,blockBounds:[ge,Fe-ue.length*x,ge+A,Fe],visibleBounds:q,timings:T})})}function c(v,_){l(v,k=>{const[U,w,x,S]=k.blockBounds;_({width:x-U,height:S-w})},{metricsOnly:!0})}function h(v){let _=v.match(/^([\d.]+)%$/),k=_?parseFloat(_[1]):NaN;return isNaN(k)?0:k/100}function y(v,_,k){const U=v[_*3],w=v[_*3+1],x=v[_*3+2],S=(w-U)/k;for(let Y=0;Y<k;Y++){const K=(_+Y)*3;v[K]=U+S*Y,v[K+1]=U+S*(Y+1),v[K+2]=x}}function m(){return(self.performance||Date).now()}function g(){this.data=[]}const D=["glyphObj","x","width","charIndex"];return g.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/D.length)},glyphAt(v){let _=g.flyweight;return _.data=this.data,_.index=v,_},splitAt(v){let _=new g;return _.data=this.data.splice(v*D.length),_}},g.flyweight=D.reduce((v,_,k,U)=>(Object.defineProperty(v,_,{get(){return this.data[this.index*D.length+k]},set(w){this.data[this.index*D.length+k]=w}}),v),{data:null,index:0}),{typeset:l,measure:c,loadFont:s}}const rt=()=>(self.performance||Date).now(),er=wn();let ln;function Aa(u,r,d,f,t,e,o,a,n,i,s=!0){return s?Pa(u,r,d,f,t,e,o,a,n,i).then(null,l=>(ln||(console.warn("WebGL SDF generation failed, falling back to JS",l),ln=!0),un(u,r,d,f,t,e,o,a,n,i))):un(u,r,d,f,t,e,o,a,n,i)}const Qt=[],Ma=5;let Fr=0;function xn(){const u=rt();for(;Qt.length&&rt()-u<Ma;)Qt.shift()();Fr=Qt.length?setTimeout(xn,0):0}const Pa=(...u)=>new Promise((r,d)=>{Qt.push(()=>{const f=rt();try{er.webgl.generateIntoCanvas(...u),r({timing:rt()-f})}catch(t){d(t)}}),Fr||(Fr=setTimeout(xn,0))}),Ga=4,Oa=2e3,fn={};let La=0;function un(u,r,d,f,t,e,o,a,n,i){const s="TroikaTextSDFGenerator_JS_"+La++%Ga;let l=fn[s];return l||(l=fn[s]={workerModule:Dt({name:s,workerId:s,dependencies:[wn,rt],init(c,h){const y=c().javascript.generate;return function(...m){const g=h();return{textureData:y(...m),timing:h()-g}}},getTransferables(c){return[c.textureData.buffer]}}),requests:0,idleTimer:null}),l.requests++,clearTimeout(l.idleTimer),l.workerModule(u,r,d,f,t,e).then(({textureData:c,timing:h})=>{const y=rt(),m=new Uint8Array(c.length*4);for(let g=0;g<c.length;g++)m[g*4+i]=c[g];return er.webglUtils.renderImageData(o,m,a,n,u,r,1<<3-i),h+=rt()-y,--l.requests===0&&(l.idleTimer=setTimeout(()=>{Ua(s)},Oa)),{timing:h}})}function Ba(u){u._warm||(er.webgl.isSupported(u),u._warm=!0)}const Ra=er.webglUtils.resizeWebGLCanvasWithoutClearing;/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function Ia(){return typeof window>"u"&&(self.window=self),function(u){var r={parse:function(t){var e=r._bin,o=new Uint8Array(t);if(e.readASCII(o,0,4)=="ttcf"){var a=4;e.readUshort(o,a),a+=2,e.readUshort(o,a),a+=2;var n=e.readUint(o,a);a+=4;for(var i=[],s=0;s<n;s++){var l=e.readUint(o,a);a+=4,i.push(r._readFont(o,l))}return i}return[r._readFont(o,0)]},_readFont:function(t,e){var o=r._bin,a=e;o.readFixed(t,e),e+=4;var n=o.readUshort(t,e);e+=2,o.readUshort(t,e),e+=2,o.readUshort(t,e),e+=2,o.readUshort(t,e),e+=2;for(var i=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],s={_data:t,_offset:a},l={},c=0;c<n;c++){var h=o.readASCII(t,e,4);e+=4,o.readUint(t,e),e+=4;var y=o.readUint(t,e);e+=4;var m=o.readUint(t,e);e+=4,l[h]={offset:y,length:m}}for(c=0;c<i.length;c++){var g=i[c];l[g]&&(s[g.trim()]=r[g.trim()].parse(t,l[g].offset,l[g].length,s))}return s},_tabOffset:function(t,e,o){for(var a=r._bin,n=a.readUshort(t,o+4),i=o+12,s=0;s<n;s++){var l=a.readASCII(t,i,4);i+=4,a.readUint(t,i),i+=4;var c=a.readUint(t,i);if(i+=4,a.readUint(t,i),i+=4,l==e)return c}return 0}};r._bin={readFixed:function(t,e){return(t[e]<<8|t[e+1])+(t[e+2]<<8|t[e+3])/65540},readF2dot14:function(t,e){return r._bin.readShort(t,e)/16384},readInt:function(t,e){return r._bin._view(t).getInt32(e)},readInt8:function(t,e){return r._bin._view(t).getInt8(e)},readShort:function(t,e){return r._bin._view(t).getInt16(e)},readUshort:function(t,e){return r._bin._view(t).getUint16(e)},readUshorts:function(t,e,o){for(var a=[],n=0;n<o;n++)a.push(r._bin.readUshort(t,e+2*n));return a},readUint:function(t,e){return r._bin._view(t).getUint32(e)},readUint64:function(t,e){return 4294967296*r._bin.readUint(t,e)+r._bin.readUint(t,e+4)},readASCII:function(t,e,o){for(var a="",n=0;n<o;n++)a+=String.fromCharCode(t[e+n]);return a},readUnicode:function(t,e,o){for(var a="",n=0;n<o;n++){var i=t[e++]<<8|t[e++];a+=String.fromCharCode(i)}return a},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(t,e,o){var a=r._bin._tdec;return a&&e==0&&o==t.length?a.decode(t):r._bin.readASCII(t,e,o)},readBytes:function(t,e,o){for(var a=[],n=0;n<o;n++)a.push(t[e+n]);return a},readASCIIArray:function(t,e,o){for(var a=[],n=0;n<o;n++)a.push(String.fromCharCode(t[e+n]));return a},_view:function(t){return t._dataView||(t._dataView=t.buffer?new DataView(t.buffer,t.byteOffset,t.byteLength):new DataView(new Uint8Array(t).buffer))}},r._lctf={},r._lctf.parse=function(t,e,o,a,n){var i=r._bin,s={},l=e;i.readFixed(t,e),e+=4;var c=i.readUshort(t,e);e+=2;var h=i.readUshort(t,e);e+=2;var y=i.readUshort(t,e);return e+=2,s.scriptList=r._lctf.readScriptList(t,l+c),s.featureList=r._lctf.readFeatureList(t,l+h),s.lookupList=r._lctf.readLookupList(t,l+y,n),s},r._lctf.readLookupList=function(t,e,o){var a=r._bin,n=e,i=[],s=a.readUshort(t,e);e+=2;for(var l=0;l<s;l++){var c=a.readUshort(t,e);e+=2;var h=r._lctf.readLookupTable(t,n+c,o);i.push(h)}return i},r._lctf.readLookupTable=function(t,e,o){var a=r._bin,n=e,i={tabs:[]};i.ltype=a.readUshort(t,e),e+=2,i.flag=a.readUshort(t,e),e+=2;var s=a.readUshort(t,e);e+=2;for(var l=i.ltype,c=0;c<s;c++){var h=a.readUshort(t,e);e+=2;var y=o(t,l,n+h,i);i.tabs.push(y)}return i},r._lctf.numOfOnes=function(t){for(var e=0,o=0;o<32;o++)t>>>o&1&&e++;return e},r._lctf.readClassDef=function(t,e){var o=r._bin,a=[],n=o.readUshort(t,e);if(e+=2,n==1){var i=o.readUshort(t,e);e+=2;var s=o.readUshort(t,e);e+=2;for(var l=0;l<s;l++)a.push(i+l),a.push(i+l),a.push(o.readUshort(t,e)),e+=2}if(n==2){var c=o.readUshort(t,e);for(e+=2,l=0;l<c;l++)a.push(o.readUshort(t,e)),e+=2,a.push(o.readUshort(t,e)),e+=2,a.push(o.readUshort(t,e)),e+=2}return a},r._lctf.getInterval=function(t,e){for(var o=0;o<t.length;o+=3){var a=t[o],n=t[o+1];if(t[o+2],a<=e&&e<=n)return o}return-1},r._lctf.readCoverage=function(t,e){var o=r._bin,a={};a.fmt=o.readUshort(t,e),e+=2;var n=o.readUshort(t,e);return e+=2,a.fmt==1&&(a.tab=o.readUshorts(t,e,n)),a.fmt==2&&(a.tab=o.readUshorts(t,e,3*n)),a},r._lctf.coverageIndex=function(t,e){var o=t.tab;if(t.fmt==1)return o.indexOf(e);if(t.fmt==2){var a=r._lctf.getInterval(o,e);if(a!=-1)return o[a+2]+(e-o[a])}return-1},r._lctf.readFeatureList=function(t,e){var o=r._bin,a=e,n=[],i=o.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var l=o.readASCII(t,e,4);e+=4;var c=o.readUshort(t,e);e+=2;var h=r._lctf.readFeatureTable(t,a+c);h.tag=l.trim(),n.push(h)}return n},r._lctf.readFeatureTable=function(t,e){var o=r._bin,a=e,n={},i=o.readUshort(t,e);e+=2,i>0&&(n.featureParams=a+i);var s=o.readUshort(t,e);e+=2,n.tab=[];for(var l=0;l<s;l++)n.tab.push(o.readUshort(t,e+2*l));return n},r._lctf.readScriptList=function(t,e){var o=r._bin,a=e,n={},i=o.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var l=o.readASCII(t,e,4);e+=4;var c=o.readUshort(t,e);e+=2,n[l.trim()]=r._lctf.readScriptTable(t,a+c)}return n},r._lctf.readScriptTable=function(t,e){var o=r._bin,a=e,n={},i=o.readUshort(t,e);e+=2,n.default=r._lctf.readLangSysTable(t,a+i);var s=o.readUshort(t,e);e+=2;for(var l=0;l<s;l++){var c=o.readASCII(t,e,4);e+=4;var h=o.readUshort(t,e);e+=2,n[c.trim()]=r._lctf.readLangSysTable(t,a+h)}return n},r._lctf.readLangSysTable=function(t,e){var o=r._bin,a={};o.readUshort(t,e),e+=2,a.reqFeature=o.readUshort(t,e),e+=2;var n=o.readUshort(t,e);return e+=2,a.features=o.readUshorts(t,e,n),a},r.CFF={},r.CFF.parse=function(t,e,o){var a=r._bin;(t=new Uint8Array(t.buffer,e,o))[e=0],t[++e],t[++e],t[++e],e++;var n=[];e=r.CFF.readIndex(t,e,n);for(var i=[],s=0;s<n.length-1;s++)i.push(a.readASCII(t,e+n[s],n[s+1]-n[s]));e+=n[n.length-1];var l=[];e=r.CFF.readIndex(t,e,l);var c=[];for(s=0;s<l.length-1;s++)c.push(r.CFF.readDict(t,e+l[s],e+l[s+1]));e+=l[l.length-1];var h=c[0],y=[];e=r.CFF.readIndex(t,e,y);var m=[];for(s=0;s<y.length-1;s++)m.push(a.readASCII(t,e+y[s],y[s+1]-y[s]));if(e+=y[y.length-1],r.CFF.readSubrs(t,e,h),h.CharStrings){e=h.CharStrings,y=[],e=r.CFF.readIndex(t,e,y);var g=[];for(s=0;s<y.length-1;s++)g.push(a.readBytes(t,e+y[s],y[s+1]-y[s]));h.CharStrings=g}if(h.ROS){e=h.FDArray;var D=[];for(e=r.CFF.readIndex(t,e,D),h.FDArray=[],s=0;s<D.length-1;s++){var v=r.CFF.readDict(t,e+D[s],e+D[s+1]);r.CFF._readFDict(t,v,m),h.FDArray.push(v)}e+=D[D.length-1],e=h.FDSelect,h.FDSelect=[];var _=t[e];if(e++,_!=3)throw _;var k=a.readUshort(t,e);for(e+=2,s=0;s<k+1;s++)h.FDSelect.push(a.readUshort(t,e),t[e+2]),e+=3}return h.Encoding&&(h.Encoding=r.CFF.readEncoding(t,h.Encoding,h.CharStrings.length)),h.charset&&(h.charset=r.CFF.readCharset(t,h.charset,h.CharStrings.length)),r.CFF._readFDict(t,h,m),h},r.CFF._readFDict=function(t,e,o){var a;for(var n in e.Private&&(a=e.Private[1],e.Private=r.CFF.readDict(t,a,a+e.Private[0]),e.Private.Subrs&&r.CFF.readSubrs(t,a+e.Private.Subrs,e.Private)),e)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(n)!=-1&&(e[n]=o[e[n]-426+35])},r.CFF.readSubrs=function(t,e,o){var a=r._bin,n=[];e=r.CFF.readIndex(t,e,n);var i,s=n.length;i=s<1240?107:s<33900?1131:32768,o.Bias=i,o.Subrs=[];for(var l=0;l<n.length-1;l++)o.Subrs.push(a.readBytes(t,e+n[l],n[l+1]-n[l]))},r.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],r.CFF.glyphByUnicode=function(t,e){for(var o=0;o<t.charset.length;o++)if(t.charset[o]==e)return o;return-1},r.CFF.glyphBySE=function(t,e){return e<0||e>255?-1:r.CFF.glyphByUnicode(t,r.CFF.tableSE[e])},r.CFF.readEncoding=function(t,e,o){r._bin;var a=[".notdef"],n=t[e];if(e++,n!=0)throw"error: unknown encoding format: "+n;var i=t[e];e++;for(var s=0;s<i;s++)a.push(t[e+s]);return a},r.CFF.readCharset=function(t,e,o){var a=r._bin,n=[".notdef"],i=t[e];if(e++,i==0)for(var s=0;s<o;s++){var l=a.readUshort(t,e);e+=2,n.push(l)}else{if(i!=1&&i!=2)throw"error: format: "+i;for(;n.length<o;){l=a.readUshort(t,e),e+=2;var c=0;for(i==1?(c=t[e],e++):(c=a.readUshort(t,e),e+=2),s=0;s<=c;s++)n.push(l),l++}}return n},r.CFF.readIndex=function(t,e,o){var a=r._bin,n=a.readUshort(t,e)+1,i=t[e+=2];if(e++,i==1)for(var s=0;s<n;s++)o.push(t[e+s]);else if(i==2)for(s=0;s<n;s++)o.push(a.readUshort(t,e+2*s));else if(i==3)for(s=0;s<n;s++)o.push(16777215&a.readUint(t,e+3*s-1));else if(n!=1)throw"unsupported offset size: "+i+", count: "+n;return(e+=n*i)-1},r.CFF.getCharString=function(t,e,o){var a=r._bin,n=t[e],i=t[e+1];t[e+2],t[e+3],t[e+4];var s=1,l=null,c=null;n<=20&&(l=n,s=1),n==12&&(l=100*n+i,s=2),21<=n&&n<=27&&(l=n,s=1),n==28&&(c=a.readShort(t,e+1),s=3),29<=n&&n<=31&&(l=n,s=1),32<=n&&n<=246&&(c=n-139,s=1),247<=n&&n<=250&&(c=256*(n-247)+i+108,s=2),251<=n&&n<=254&&(c=256*-(n-251)-i-108,s=2),n==255&&(c=a.readInt(t,e+1)/65535,s=5),o.val=c??"o"+l,o.size=s},r.CFF.readCharString=function(t,e,o){for(var a=e+o,n=r._bin,i=[];e<a;){var s=t[e],l=t[e+1];t[e+2],t[e+3],t[e+4];var c=1,h=null,y=null;s<=20&&(h=s,c=1),s==12&&(h=100*s+l,c=2),s!=19&&s!=20||(h=s,c=2),21<=s&&s<=27&&(h=s,c=1),s==28&&(y=n.readShort(t,e+1),c=3),29<=s&&s<=31&&(h=s,c=1),32<=s&&s<=246&&(y=s-139,c=1),247<=s&&s<=250&&(y=256*(s-247)+l+108,c=2),251<=s&&s<=254&&(y=256*-(s-251)-l-108,c=2),s==255&&(y=n.readInt(t,e+1)/65535,c=5),i.push(y??"o"+h),e+=c}return i},r.CFF.readDict=function(t,e,o){for(var a=r._bin,n={},i=[];e<o;){var s=t[e],l=t[e+1];t[e+2],t[e+3],t[e+4];var c=1,h=null,y=null;if(s==28&&(y=a.readShort(t,e+1),c=3),s==29&&(y=a.readInt(t,e+1),c=5),32<=s&&s<=246&&(y=s-139,c=1),247<=s&&s<=250&&(y=256*(s-247)+l+108,c=2),251<=s&&s<=254&&(y=256*-(s-251)-l-108,c=2),s==255)throw y=a.readInt(t,e+1)/65535,c=5,"unknown number";if(s==30){var m=[];for(c=1;;){var g=t[e+c];c++;var D=g>>4,v=15&g;if(D!=15&&m.push(D),v!=15&&m.push(v),v==15)break}for(var _="",k=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],U=0;U<m.length;U++)_+=k[m[U]];y=parseFloat(_)}s<=21&&(h=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],c=1,s==12&&(h=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][l],c=2)),h!=null?(n[h]=i.length==1?i[0]:i,i=[]):i.push(y),e+=c}return n},r.cmap={},r.cmap.parse=function(t,e,o){t=new Uint8Array(t.buffer,e,o),e=0;var a=r._bin,n={};a.readUshort(t,e),e+=2;var i=a.readUshort(t,e);e+=2;var s=[];n.tables=[];for(var l=0;l<i;l++){var c=a.readUshort(t,e);e+=2;var h=a.readUshort(t,e);e+=2;var y=a.readUint(t,e);e+=4;var m="p"+c+"e"+h,g=s.indexOf(y);if(g==-1){var D;g=n.tables.length,s.push(y);var v=a.readUshort(t,y);v==0?D=r.cmap.parse0(t,y):v==4?D=r.cmap.parse4(t,y):v==6?D=r.cmap.parse6(t,y):v==12?D=r.cmap.parse12(t,y):console.debug("unknown format: "+v,c,h,y),n.tables.push(D)}if(n[m]!=null)throw"multiple tables for one platform+encoding";n[m]=g}return n},r.cmap.parse0=function(t,e){var o=r._bin,a={};a.format=o.readUshort(t,e),e+=2;var n=o.readUshort(t,e);e+=2,o.readUshort(t,e),e+=2,a.map=[];for(var i=0;i<n-6;i++)a.map.push(t[e+i]);return a},r.cmap.parse4=function(t,e){var o=r._bin,a=e,n={};n.format=o.readUshort(t,e),e+=2;var i=o.readUshort(t,e);e+=2,o.readUshort(t,e),e+=2;var s=o.readUshort(t,e);e+=2;var l=s/2;n.searchRange=o.readUshort(t,e),e+=2,n.entrySelector=o.readUshort(t,e),e+=2,n.rangeShift=o.readUshort(t,e),e+=2,n.endCount=o.readUshorts(t,e,l),e+=2*l,e+=2,n.startCount=o.readUshorts(t,e,l),e+=2*l,n.idDelta=[];for(var c=0;c<l;c++)n.idDelta.push(o.readShort(t,e)),e+=2;for(n.idRangeOffset=o.readUshorts(t,e,l),e+=2*l,n.glyphIdArray=[];e<a+i;)n.glyphIdArray.push(o.readUshort(t,e)),e+=2;return n},r.cmap.parse6=function(t,e){var o=r._bin,a={};a.format=o.readUshort(t,e),e+=2,o.readUshort(t,e),e+=2,o.readUshort(t,e),e+=2,a.firstCode=o.readUshort(t,e),e+=2;var n=o.readUshort(t,e);e+=2,a.glyphIdArray=[];for(var i=0;i<n;i++)a.glyphIdArray.push(o.readUshort(t,e)),e+=2;return a},r.cmap.parse12=function(t,e){var o=r._bin,a={};a.format=o.readUshort(t,e),e+=2,e+=2,o.readUint(t,e),e+=4,o.readUint(t,e),e+=4;var n=o.readUint(t,e);e+=4,a.groups=[];for(var i=0;i<n;i++){var s=e+12*i,l=o.readUint(t,s+0),c=o.readUint(t,s+4),h=o.readUint(t,s+8);a.groups.push([l,c,h])}return a},r.glyf={},r.glyf.parse=function(t,e,o,a){for(var n=[],i=0;i<a.maxp.numGlyphs;i++)n.push(null);return n},r.glyf._parseGlyf=function(t,e){var o=r._bin,a=t._data,n=r._tabOffset(a,"glyf",t._offset)+t.loca[e];if(t.loca[e]==t.loca[e+1])return null;var i={};if(i.noc=o.readShort(a,n),n+=2,i.xMin=o.readShort(a,n),n+=2,i.yMin=o.readShort(a,n),n+=2,i.xMax=o.readShort(a,n),n+=2,i.yMax=o.readShort(a,n),n+=2,i.xMin>=i.xMax||i.yMin>=i.yMax)return null;if(i.noc>0){i.endPts=[];for(var s=0;s<i.noc;s++)i.endPts.push(o.readUshort(a,n)),n+=2;var l=o.readUshort(a,n);if(n+=2,a.length-n<l)return null;i.instructions=o.readBytes(a,n,l),n+=l;var c=i.endPts[i.noc-1]+1;for(i.flags=[],s=0;s<c;s++){var h=a[n];if(n++,i.flags.push(h),(8&h)!=0){var y=a[n];n++;for(var m=0;m<y;m++)i.flags.push(h),s++}}for(i.xs=[],s=0;s<c;s++){var g=(2&i.flags[s])!=0,D=(16&i.flags[s])!=0;g?(i.xs.push(D?a[n]:-a[n]),n++):D?i.xs.push(0):(i.xs.push(o.readShort(a,n)),n+=2)}for(i.ys=[],s=0;s<c;s++)g=(4&i.flags[s])!=0,D=(32&i.flags[s])!=0,g?(i.ys.push(D?a[n]:-a[n]),n++):D?i.ys.push(0):(i.ys.push(o.readShort(a,n)),n+=2);var v=0,_=0;for(s=0;s<c;s++)v+=i.xs[s],_+=i.ys[s],i.xs[s]=v,i.ys[s]=_}else{var k;i.parts=[];do{k=o.readUshort(a,n),n+=2;var U={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(i.parts.push(U),U.glyphIndex=o.readUshort(a,n),n+=2,1&k){var w=o.readShort(a,n);n+=2;var x=o.readShort(a,n);n+=2}else w=o.readInt8(a,n),n++,x=o.readInt8(a,n),n++;2&k?(U.m.tx=w,U.m.ty=x):(U.p1=w,U.p2=x),8&k?(U.m.a=U.m.d=o.readF2dot14(a,n),n+=2):64&k?(U.m.a=o.readF2dot14(a,n),n+=2,U.m.d=o.readF2dot14(a,n),n+=2):128&k&&(U.m.a=o.readF2dot14(a,n),n+=2,U.m.b=o.readF2dot14(a,n),n+=2,U.m.c=o.readF2dot14(a,n),n+=2,U.m.d=o.readF2dot14(a,n),n+=2)}while(32&k);if(256&k){var S=o.readUshort(a,n);for(n+=2,i.instr=[],s=0;s<S;s++)i.instr.push(a[n]),n++}}return i},r.GPOS={},r.GPOS.parse=function(t,e,o,a){return r._lctf.parse(t,e,o,a,r.GPOS.subt)},r.GPOS.subt=function(t,e,o,a){var n=r._bin,i=o,s={};if(s.fmt=n.readUshort(t,o),o+=2,e==1||e==2||e==3||e==7||e==8&&s.fmt<=2){var l=n.readUshort(t,o);o+=2,s.coverage=r._lctf.readCoverage(t,l+i)}if(e==1&&s.fmt==1){var c=n.readUshort(t,o);o+=2;var h=r._lctf.numOfOnes(c);c!=0&&(s.pos=r.GPOS.readValueRecord(t,o,c))}else if(e==2&&s.fmt>=1&&s.fmt<=2){c=n.readUshort(t,o),o+=2;var y=n.readUshort(t,o);o+=2,h=r._lctf.numOfOnes(c);var m=r._lctf.numOfOnes(y);if(s.fmt==1){s.pairsets=[];var g=n.readUshort(t,o);o+=2;for(var D=0;D<g;D++){var v=i+n.readUshort(t,o);o+=2;var _=n.readUshort(t,v);v+=2;for(var k=[],U=0;U<_;U++){var w=n.readUshort(t,v);v+=2,c!=0&&(b=r.GPOS.readValueRecord(t,v,c),v+=2*h),y!=0&&(R=r.GPOS.readValueRecord(t,v,y),v+=2*m),k.push({gid2:w,val1:b,val2:R})}s.pairsets.push(k)}}if(s.fmt==2){var x=n.readUshort(t,o);o+=2;var S=n.readUshort(t,o);o+=2;var Y=n.readUshort(t,o);o+=2;var K=n.readUshort(t,o);for(o+=2,s.classDef1=r._lctf.readClassDef(t,i+x),s.classDef2=r._lctf.readClassDef(t,i+S),s.matrix=[],D=0;D<Y;D++){var ne=[];for(U=0;U<K;U++){var b=null,R=null;c!=0&&(b=r.GPOS.readValueRecord(t,o,c),o+=2*h),y!=0&&(R=r.GPOS.readValueRecord(t,o,y),o+=2*m),ne.push({val1:b,val2:R})}s.matrix.push(ne)}}}else{if(e==9&&s.fmt==1){var E=n.readUshort(t,o);o+=2;var j=n.readUint(t,o);if(o+=4,a.ltype==9)a.ltype=E;else if(a.ltype!=E)throw"invalid extension substitution";return r.GPOS.subt(t,a.ltype,i+j)}console.debug("unsupported GPOS table LookupType",e,"format",s.fmt)}return s},r.GPOS.readValueRecord=function(t,e,o){var a=r._bin,n=[];return n.push(1&o?a.readShort(t,e):0),e+=1&o?2:0,n.push(2&o?a.readShort(t,e):0),e+=2&o?2:0,n.push(4&o?a.readShort(t,e):0),e+=4&o?2:0,n.push(8&o?a.readShort(t,e):0),e+=8&o?2:0,n},r.GSUB={},r.GSUB.parse=function(t,e,o,a){return r._lctf.parse(t,e,o,a,r.GSUB.subt)},r.GSUB.subt=function(t,e,o,a){var n=r._bin,i=o,s={};if(s.fmt=n.readUshort(t,o),o+=2,e!=1&&e!=4&&e!=5&&e!=6)return null;if(e==1||e==4||e==5&&s.fmt<=2||e==6&&s.fmt<=2){var l=n.readUshort(t,o);o+=2,s.coverage=r._lctf.readCoverage(t,i+l)}if(e==1&&s.fmt>=1&&s.fmt<=2){if(s.fmt==1)s.delta=n.readShort(t,o),o+=2;else if(s.fmt==2){var c=n.readUshort(t,o);o+=2,s.newg=n.readUshorts(t,o,c),o+=2*s.newg.length}}else if(e==4){s.vals=[],c=n.readUshort(t,o),o+=2;for(var h=0;h<c;h++){var y=n.readUshort(t,o);o+=2,s.vals.push(r.GSUB.readLigatureSet(t,i+y))}}else if(e==5&&s.fmt==2){if(s.fmt==2){var m=n.readUshort(t,o);o+=2,s.cDef=r._lctf.readClassDef(t,i+m),s.scset=[];var g=n.readUshort(t,o);for(o+=2,h=0;h<g;h++){var D=n.readUshort(t,o);o+=2,s.scset.push(D==0?null:r.GSUB.readSubClassSet(t,i+D))}}}else if(e==6&&s.fmt==3){if(s.fmt==3){for(h=0;h<3;h++){c=n.readUshort(t,o),o+=2;for(var v=[],_=0;_<c;_++)v.push(r._lctf.readCoverage(t,i+n.readUshort(t,o+2*_)));o+=2*c,h==0&&(s.backCvg=v),h==1&&(s.inptCvg=v),h==2&&(s.ahedCvg=v)}c=n.readUshort(t,o),o+=2,s.lookupRec=r.GSUB.readSubstLookupRecords(t,o,c)}}else{if(e==7&&s.fmt==1){var k=n.readUshort(t,o);o+=2;var U=n.readUint(t,o);if(o+=4,a.ltype==9)a.ltype=k;else if(a.ltype!=k)throw"invalid extension substitution";return r.GSUB.subt(t,a.ltype,i+U)}console.debug("unsupported GSUB table LookupType",e,"format",s.fmt)}return s},r.GSUB.readSubClassSet=function(t,e){var o=r._bin.readUshort,a=e,n=[],i=o(t,e);e+=2;for(var s=0;s<i;s++){var l=o(t,e);e+=2,n.push(r.GSUB.readSubClassRule(t,a+l))}return n},r.GSUB.readSubClassRule=function(t,e){var o=r._bin.readUshort,a={},n=o(t,e),i=o(t,e+=2);e+=2,a.input=[];for(var s=0;s<n-1;s++)a.input.push(o(t,e)),e+=2;return a.substLookupRecords=r.GSUB.readSubstLookupRecords(t,e,i),a},r.GSUB.readSubstLookupRecords=function(t,e,o){for(var a=r._bin.readUshort,n=[],i=0;i<o;i++)n.push(a(t,e),a(t,e+2)),e+=4;return n},r.GSUB.readChainSubClassSet=function(t,e){var o=r._bin,a=e,n=[],i=o.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var l=o.readUshort(t,e);e+=2,n.push(r.GSUB.readChainSubClassRule(t,a+l))}return n},r.GSUB.readChainSubClassRule=function(t,e){for(var o=r._bin,a={},n=["backtrack","input","lookahead"],i=0;i<n.length;i++){var s=o.readUshort(t,e);e+=2,i==1&&s--,a[n[i]]=o.readUshorts(t,e,s),e+=2*a[n[i]].length}return s=o.readUshort(t,e),e+=2,a.subst=o.readUshorts(t,e,2*s),e+=2*a.subst.length,a},r.GSUB.readLigatureSet=function(t,e){var o=r._bin,a=e,n=[],i=o.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var l=o.readUshort(t,e);e+=2,n.push(r.GSUB.readLigature(t,a+l))}return n},r.GSUB.readLigature=function(t,e){var o=r._bin,a={chain:[]};a.nglyph=o.readUshort(t,e),e+=2;var n=o.readUshort(t,e);e+=2;for(var i=0;i<n-1;i++)a.chain.push(o.readUshort(t,e)),e+=2;return a},r.head={},r.head.parse=function(t,e,o){var a=r._bin,n={};return a.readFixed(t,e),e+=4,n.fontRevision=a.readFixed(t,e),e+=4,a.readUint(t,e),e+=4,a.readUint(t,e),e+=4,n.flags=a.readUshort(t,e),e+=2,n.unitsPerEm=a.readUshort(t,e),e+=2,n.created=a.readUint64(t,e),e+=8,n.modified=a.readUint64(t,e),e+=8,n.xMin=a.readShort(t,e),e+=2,n.yMin=a.readShort(t,e),e+=2,n.xMax=a.readShort(t,e),e+=2,n.yMax=a.readShort(t,e),e+=2,n.macStyle=a.readUshort(t,e),e+=2,n.lowestRecPPEM=a.readUshort(t,e),e+=2,n.fontDirectionHint=a.readShort(t,e),e+=2,n.indexToLocFormat=a.readShort(t,e),e+=2,n.glyphDataFormat=a.readShort(t,e),e+=2,n},r.hhea={},r.hhea.parse=function(t,e,o){var a=r._bin,n={};return a.readFixed(t,e),e+=4,n.ascender=a.readShort(t,e),e+=2,n.descender=a.readShort(t,e),e+=2,n.lineGap=a.readShort(t,e),e+=2,n.advanceWidthMax=a.readUshort(t,e),e+=2,n.minLeftSideBearing=a.readShort(t,e),e+=2,n.minRightSideBearing=a.readShort(t,e),e+=2,n.xMaxExtent=a.readShort(t,e),e+=2,n.caretSlopeRise=a.readShort(t,e),e+=2,n.caretSlopeRun=a.readShort(t,e),e+=2,n.caretOffset=a.readShort(t,e),e+=2,e+=8,n.metricDataFormat=a.readShort(t,e),e+=2,n.numberOfHMetrics=a.readUshort(t,e),e+=2,n},r.hmtx={},r.hmtx.parse=function(t,e,o,a){for(var n=r._bin,i={aWidth:[],lsBearing:[]},s=0,l=0,c=0;c<a.maxp.numGlyphs;c++)c<a.hhea.numberOfHMetrics&&(s=n.readUshort(t,e),e+=2,l=n.readShort(t,e),e+=2),i.aWidth.push(s),i.lsBearing.push(l);return i},r.kern={},r.kern.parse=function(t,e,o,a){var n=r._bin,i=n.readUshort(t,e);if(e+=2,i==1)return r.kern.parseV1(t,e-2,o,a);var s=n.readUshort(t,e);e+=2;for(var l={glyph1:[],rval:[]},c=0;c<s;c++){e+=2,o=n.readUshort(t,e),e+=2;var h=n.readUshort(t,e);e+=2;var y=h>>>8;if((y&=15)!=0)throw"unknown kern table format: "+y;e=r.kern.readFormat0(t,e,l)}return l},r.kern.parseV1=function(t,e,o,a){var n=r._bin;n.readFixed(t,e),e+=4;var i=n.readUint(t,e);e+=4;for(var s={glyph1:[],rval:[]},l=0;l<i;l++){n.readUint(t,e),e+=4;var c=n.readUshort(t,e);e+=2,n.readUshort(t,e),e+=2;var h=c>>>8;if((h&=15)!=0)throw"unknown kern table format: "+h;e=r.kern.readFormat0(t,e,s)}return s},r.kern.readFormat0=function(t,e,o){var a=r._bin,n=-1,i=a.readUshort(t,e);e+=2,a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2;for(var s=0;s<i;s++){var l=a.readUshort(t,e);e+=2;var c=a.readUshort(t,e);e+=2;var h=a.readShort(t,e);e+=2,l!=n&&(o.glyph1.push(l),o.rval.push({glyph2:[],vals:[]}));var y=o.rval[o.rval.length-1];y.glyph2.push(c),y.vals.push(h),n=l}return e},r.loca={},r.loca.parse=function(t,e,o,a){var n=r._bin,i=[],s=a.head.indexToLocFormat,l=a.maxp.numGlyphs+1;if(s==0)for(var c=0;c<l;c++)i.push(n.readUshort(t,e+(c<<1))<<1);if(s==1)for(c=0;c<l;c++)i.push(n.readUint(t,e+(c<<2)));return i},r.maxp={},r.maxp.parse=function(t,e,o){var a=r._bin,n={},i=a.readUint(t,e);return e+=4,n.numGlyphs=a.readUshort(t,e),e+=2,i==65536&&(n.maxPoints=a.readUshort(t,e),e+=2,n.maxContours=a.readUshort(t,e),e+=2,n.maxCompositePoints=a.readUshort(t,e),e+=2,n.maxCompositeContours=a.readUshort(t,e),e+=2,n.maxZones=a.readUshort(t,e),e+=2,n.maxTwilightPoints=a.readUshort(t,e),e+=2,n.maxStorage=a.readUshort(t,e),e+=2,n.maxFunctionDefs=a.readUshort(t,e),e+=2,n.maxInstructionDefs=a.readUshort(t,e),e+=2,n.maxStackElements=a.readUshort(t,e),e+=2,n.maxSizeOfInstructions=a.readUshort(t,e),e+=2,n.maxComponentElements=a.readUshort(t,e),e+=2,n.maxComponentDepth=a.readUshort(t,e),e+=2),n},r.name={},r.name.parse=function(t,e,o){var a=r._bin,n={};a.readUshort(t,e),e+=2;var i=a.readUshort(t,e);e+=2,a.readUshort(t,e);for(var s,l=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],c=e+=2,h=0;h<i;h++){var y=a.readUshort(t,e);e+=2;var m=a.readUshort(t,e);e+=2;var g=a.readUshort(t,e);e+=2;var D=a.readUshort(t,e);e+=2;var v=a.readUshort(t,e);e+=2;var _=a.readUshort(t,e);e+=2;var k,U=l[D],w=c+12*i+_;if(y==0)k=a.readUnicode(t,w,v/2);else if(y==3&&m==0)k=a.readUnicode(t,w,v/2);else if(m==0)k=a.readASCII(t,w,v);else if(m==1)k=a.readUnicode(t,w,v/2);else if(m==3)k=a.readUnicode(t,w,v/2);else{if(y!=1)throw"unknown encoding "+m+", platformID: "+y;k=a.readASCII(t,w,v),console.debug("reading unknown MAC encoding "+m+" as ASCII")}var x="p"+y+","+g.toString(16);n[x]==null&&(n[x]={}),n[x][U!==void 0?U:D]=k,n[x]._lang=g}for(var S in n)if(n[S].postScriptName!=null&&n[S]._lang==1033)return n[S];for(var S in n)if(n[S].postScriptName!=null&&n[S]._lang==0)return n[S];for(var S in n)if(n[S].postScriptName!=null&&n[S]._lang==3084)return n[S];for(var S in n)if(n[S].postScriptName!=null)return n[S];for(var S in n){s=S;break}return console.debug("returning name table with languageID "+n[s]._lang),n[s]},r["OS/2"]={},r["OS/2"].parse=function(t,e,o){var a=r._bin.readUshort(t,e);e+=2;var n={};if(a==0)r["OS/2"].version0(t,e,n);else if(a==1)r["OS/2"].version1(t,e,n);else if(a==2||a==3||a==4)r["OS/2"].version2(t,e,n);else{if(a!=5)throw"unknown OS/2 table version: "+a;r["OS/2"].version5(t,e,n)}return n},r["OS/2"].version0=function(t,e,o){var a=r._bin;return o.xAvgCharWidth=a.readShort(t,e),e+=2,o.usWeightClass=a.readUshort(t,e),e+=2,o.usWidthClass=a.readUshort(t,e),e+=2,o.fsType=a.readUshort(t,e),e+=2,o.ySubscriptXSize=a.readShort(t,e),e+=2,o.ySubscriptYSize=a.readShort(t,e),e+=2,o.ySubscriptXOffset=a.readShort(t,e),e+=2,o.ySubscriptYOffset=a.readShort(t,e),e+=2,o.ySuperscriptXSize=a.readShort(t,e),e+=2,o.ySuperscriptYSize=a.readShort(t,e),e+=2,o.ySuperscriptXOffset=a.readShort(t,e),e+=2,o.ySuperscriptYOffset=a.readShort(t,e),e+=2,o.yStrikeoutSize=a.readShort(t,e),e+=2,o.yStrikeoutPosition=a.readShort(t,e),e+=2,o.sFamilyClass=a.readShort(t,e),e+=2,o.panose=a.readBytes(t,e,10),e+=10,o.ulUnicodeRange1=a.readUint(t,e),e+=4,o.ulUnicodeRange2=a.readUint(t,e),e+=4,o.ulUnicodeRange3=a.readUint(t,e),e+=4,o.ulUnicodeRange4=a.readUint(t,e),e+=4,o.achVendID=[a.readInt8(t,e),a.readInt8(t,e+1),a.readInt8(t,e+2),a.readInt8(t,e+3)],e+=4,o.fsSelection=a.readUshort(t,e),e+=2,o.usFirstCharIndex=a.readUshort(t,e),e+=2,o.usLastCharIndex=a.readUshort(t,e),e+=2,o.sTypoAscender=a.readShort(t,e),e+=2,o.sTypoDescender=a.readShort(t,e),e+=2,o.sTypoLineGap=a.readShort(t,e),e+=2,o.usWinAscent=a.readUshort(t,e),e+=2,o.usWinDescent=a.readUshort(t,e),e+=2},r["OS/2"].version1=function(t,e,o){var a=r._bin;return e=r["OS/2"].version0(t,e,o),o.ulCodePageRange1=a.readUint(t,e),e+=4,o.ulCodePageRange2=a.readUint(t,e),e+=4},r["OS/2"].version2=function(t,e,o){var a=r._bin;return e=r["OS/2"].version1(t,e,o),o.sxHeight=a.readShort(t,e),e+=2,o.sCapHeight=a.readShort(t,e),e+=2,o.usDefault=a.readUshort(t,e),e+=2,o.usBreak=a.readUshort(t,e),e+=2,o.usMaxContext=a.readUshort(t,e),e+=2},r["OS/2"].version5=function(t,e,o){var a=r._bin;return e=r["OS/2"].version2(t,e,o),o.usLowerOpticalPointSize=a.readUshort(t,e),e+=2,o.usUpperOpticalPointSize=a.readUshort(t,e),e+=2},r.post={},r.post.parse=function(t,e,o){var a=r._bin,n={};return n.version=a.readFixed(t,e),e+=4,n.italicAngle=a.readFixed(t,e),e+=4,n.underlinePosition=a.readShort(t,e),e+=2,n.underlineThickness=a.readShort(t,e),e+=2,n},r==null&&(r={}),r.U==null&&(r.U={}),r.U.codeToGlyph=function(t,e){var o=t.cmap,a=-1;if(o.p0e4!=null?a=o.p0e4:o.p3e1!=null?a=o.p3e1:o.p1e0!=null?a=o.p1e0:o.p0e3!=null&&(a=o.p0e3),a==-1)throw"no familiar platform and encoding!";var n=o.tables[a];if(n.format==0)return e>=n.map.length?0:n.map[e];if(n.format==4){for(var i=-1,s=0;s<n.endCount.length;s++)if(e<=n.endCount[s]){i=s;break}return i==-1||n.startCount[i]>e?0:65535&(n.idRangeOffset[i]!=0?n.glyphIdArray[e-n.startCount[i]+(n.idRangeOffset[i]>>1)-(n.idRangeOffset.length-i)]:e+n.idDelta[i])}if(n.format==12){if(e>n.groups[n.groups.length-1][1])return 0;for(s=0;s<n.groups.length;s++){var l=n.groups[s];if(l[0]<=e&&e<=l[1])return l[2]+(e-l[0])}return 0}throw"unknown cmap table format "+n.format},r.U.glyphToPath=function(t,e){var o={cmds:[],crds:[]};if(t.SVG&&t.SVG.entries[e]){var a=t.SVG.entries[e];return a==null?o:(typeof a=="string"&&(a=r.SVG.toPath(a),t.SVG.entries[e]=a),a)}if(t.CFF){var n={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:t.CFF.Private?t.CFF.Private.defaultWidthX:0,open:!1},i=t.CFF,s=t.CFF.Private;if(i.ROS){for(var l=0;i.FDSelect[l+2]<=e;)l+=2;s=i.FDArray[i.FDSelect[l+1]].Private}r.U._drawCFF(t.CFF.CharStrings[e],n,i,s,o)}else t.glyf&&r.U._drawGlyf(e,t,o);return o},r.U._drawGlyf=function(t,e,o){var a=e.glyf[t];a==null&&(a=e.glyf[t]=r.glyf._parseGlyf(e,t)),a!=null&&(a.noc>-1?r.U._simpleGlyph(a,o):r.U._compoGlyph(a,e,o))},r.U._simpleGlyph=function(t,e){for(var o=0;o<t.noc;o++){for(var a=o==0?0:t.endPts[o-1]+1,n=t.endPts[o],i=a;i<=n;i++){var s=i==a?n:i-1,l=i==n?a:i+1,c=1&t.flags[i],h=1&t.flags[s],y=1&t.flags[l],m=t.xs[i],g=t.ys[i];if(i==a)if(c){if(!h){r.U.P.moveTo(e,m,g);continue}r.U.P.moveTo(e,t.xs[s],t.ys[s])}else h?r.U.P.moveTo(e,t.xs[s],t.ys[s]):r.U.P.moveTo(e,(t.xs[s]+m)/2,(t.ys[s]+g)/2);c?h&&r.U.P.lineTo(e,m,g):y?r.U.P.qcurveTo(e,m,g,t.xs[l],t.ys[l]):r.U.P.qcurveTo(e,m,g,(m+t.xs[l])/2,(g+t.ys[l])/2)}r.U.P.closePath(e)}},r.U._compoGlyph=function(t,e,o){for(var a=0;a<t.parts.length;a++){var n={cmds:[],crds:[]},i=t.parts[a];r.U._drawGlyf(i.glyphIndex,e,n);for(var s=i.m,l=0;l<n.crds.length;l+=2){var c=n.crds[l],h=n.crds[l+1];o.crds.push(c*s.a+h*s.b+s.tx),o.crds.push(c*s.c+h*s.d+s.ty)}for(l=0;l<n.cmds.length;l++)o.cmds.push(n.cmds[l])}},r.U._getGlyphClass=function(t,e){var o=r._lctf.getInterval(e,t);return o==-1?0:e[o+2]},r.U.getPairAdjustment=function(t,e,o){var a=!1;if(t.GPOS)for(var n=t.GPOS,i=n.lookupList,s=n.featureList,l=[],c=0;c<s.length;c++){var h=s[c];if(h.tag=="kern"){a=!0;for(var y=0;y<h.tab.length;y++)if(!l[h.tab[y]]){l[h.tab[y]]=!0;for(var m=i[h.tab[y]],g=0;g<m.tabs.length;g++)if(m.tabs[g]!=null){var D,v=m.tabs[g];if((!v.coverage||(D=r._lctf.coverageIndex(v.coverage,e))!=-1)&&m.ltype!=1){if(m.ltype==2){var _=null;if(v.fmt==1){var k=v.pairsets[D];for(c=0;c<k.length;c++)k[c].gid2==o&&(_=k[c])}else if(v.fmt==2){var U=r.U._getGlyphClass(e,v.classDef1),w=r.U._getGlyphClass(o,v.classDef2);_=v.matrix[U][w]}if(_){var x=0;return _.val1&&_.val1[2]&&(x+=_.val1[2]),_.val2&&_.val2[0]&&(x+=_.val2[0]),x}}}}}}}if(t.kern&&!a){var S=t.kern.glyph1.indexOf(e);if(S!=-1){var Y=t.kern.rval[S].glyph2.indexOf(o);if(Y!=-1)return t.kern.rval[S].vals[Y]}}return 0},r.U._applySubs=function(t,e,o,a){for(var n=t.length-e-1,i=0;i<o.tabs.length;i++)if(o.tabs[i]!=null){var s,l=o.tabs[i];if(!l.coverage||(s=r._lctf.coverageIndex(l.coverage,t[e]))!=-1){if(o.ltype==1)t[e],l.fmt==1?t[e]=t[e]+l.delta:t[e]=l.newg[s];else if(o.ltype==4)for(var c=l.vals[s],h=0;h<c.length;h++){var y=c[h],m=y.chain.length;if(!(m>n)){for(var g=!0,D=0,v=0;v<m;v++){for(;t[e+D+(1+v)]==-1;)D++;y.chain[v]!=t[e+D+(1+v)]&&(g=!1)}if(g){for(t[e]=y.nglyph,v=0;v<m+D;v++)t[e+v+1]=-1;break}}}else if(o.ltype==5&&l.fmt==2)for(var _=r._lctf.getInterval(l.cDef,t[e]),k=l.cDef[_+2],U=l.scset[k],w=0;w<U.length;w++){var x=U[w],S=x.input;if(!(S.length>n)){for(g=!0,v=0;v<S.length;v++){var Y=r._lctf.getInterval(l.cDef,t[e+1+v]);if(_==-1&&l.cDef[Y+2]!=S[v]){g=!1;break}}if(g){var K=x.substLookupRecords;for(h=0;h<K.length;h+=2)K[h],K[h+1]}}}else if(o.ltype==6&&l.fmt==3){if(!r.U._glsCovered(t,l.backCvg,e-l.backCvg.length)||!r.U._glsCovered(t,l.inptCvg,e)||!r.U._glsCovered(t,l.ahedCvg,e+l.inptCvg.length))continue;var ne=l.lookupRec;for(w=0;w<ne.length;w+=2){_=ne[w];var b=a[ne[w+1]];r.U._applySubs(t,e+_,b,a)}}}}},r.U._glsCovered=function(t,e,o){for(var a=0;a<e.length;a++)if(r._lctf.coverageIndex(e[a],t[o+a])==-1)return!1;return!0},r.U.glyphsToPath=function(t,e,o){for(var a={cmds:[],crds:[]},n=0,i=0;i<e.length;i++){var s=e[i];if(s!=-1){for(var l=i<e.length-1&&e[i+1]!=-1?e[i+1]:0,c=r.U.glyphToPath(t,s),h=0;h<c.crds.length;h+=2)a.crds.push(c.crds[h]+n),a.crds.push(c.crds[h+1]);for(o&&a.cmds.push(o),h=0;h<c.cmds.length;h++)a.cmds.push(c.cmds[h]);o&&a.cmds.push("X"),n+=t.hmtx.aWidth[s],i<e.length-1&&(n+=r.U.getPairAdjustment(t,s,l))}}return a},r.U.P={},r.U.P.moveTo=function(t,e,o){t.cmds.push("M"),t.crds.push(e,o)},r.U.P.lineTo=function(t,e,o){t.cmds.push("L"),t.crds.push(e,o)},r.U.P.curveTo=function(t,e,o,a,n,i,s){t.cmds.push("C"),t.crds.push(e,o,a,n,i,s)},r.U.P.qcurveTo=function(t,e,o,a,n){t.cmds.push("Q"),t.crds.push(e,o,a,n)},r.U.P.closePath=function(t){t.cmds.push("Z")},r.U._drawCFF=function(t,e,o,a,n){for(var i=e.stack,s=e.nStems,l=e.haveWidth,c=e.width,h=e.open,y=0,m=e.x,g=e.y,D=0,v=0,_=0,k=0,U=0,w=0,x=0,S=0,Y=0,K=0,ne={val:0,size:0};y<t.length;){r.CFF.getCharString(t,y,ne);var b=ne.val;if(y+=ne.size,b=="o1"||b=="o18")i.length%2!=0&&!l&&(c=i.shift()+a.nominalWidthX),s+=i.length>>1,i.length=0,l=!0;else if(b=="o3"||b=="o23")i.length%2!=0&&!l&&(c=i.shift()+a.nominalWidthX),s+=i.length>>1,i.length=0,l=!0;else if(b=="o4")i.length>1&&!l&&(c=i.shift()+a.nominalWidthX,l=!0),h&&r.U.P.closePath(n),g+=i.pop(),r.U.P.moveTo(n,m,g),h=!0;else if(b=="o5")for(;i.length>0;)m+=i.shift(),g+=i.shift(),r.U.P.lineTo(n,m,g);else if(b=="o6"||b=="o7")for(var R=i.length,E=b=="o6",j=0;j<R;j++){var N=i.shift();E?m+=N:g+=N,E=!E,r.U.P.lineTo(n,m,g)}else if(b=="o8"||b=="o24"){R=i.length;for(var se=0;se+6<=R;)D=m+i.shift(),v=g+i.shift(),_=D+i.shift(),k=v+i.shift(),m=_+i.shift(),g=k+i.shift(),r.U.P.curveTo(n,D,v,_,k,m,g),se+=6;b=="o24"&&(m+=i.shift(),g+=i.shift(),r.U.P.lineTo(n,m,g))}else{if(b=="o11")break;if(b=="o1234"||b=="o1235"||b=="o1236"||b=="o1237")b=="o1234"&&(v=g,_=(D=m+i.shift())+i.shift(),K=k=v+i.shift(),w=k,S=g,m=(x=(U=(Y=_+i.shift())+i.shift())+i.shift())+i.shift(),r.U.P.curveTo(n,D,v,_,k,Y,K),r.U.P.curveTo(n,U,w,x,S,m,g)),b=="o1235"&&(D=m+i.shift(),v=g+i.shift(),_=D+i.shift(),k=v+i.shift(),Y=_+i.shift(),K=k+i.shift(),U=Y+i.shift(),w=K+i.shift(),x=U+i.shift(),S=w+i.shift(),m=x+i.shift(),g=S+i.shift(),i.shift(),r.U.P.curveTo(n,D,v,_,k,Y,K),r.U.P.curveTo(n,U,w,x,S,m,g)),b=="o1236"&&(D=m+i.shift(),v=g+i.shift(),_=D+i.shift(),K=k=v+i.shift(),w=k,x=(U=(Y=_+i.shift())+i.shift())+i.shift(),S=w+i.shift(),m=x+i.shift(),r.U.P.curveTo(n,D,v,_,k,Y,K),r.U.P.curveTo(n,U,w,x,S,m,g)),b=="o1237"&&(D=m+i.shift(),v=g+i.shift(),_=D+i.shift(),k=v+i.shift(),Y=_+i.shift(),K=k+i.shift(),U=Y+i.shift(),w=K+i.shift(),x=U+i.shift(),S=w+i.shift(),Math.abs(x-m)>Math.abs(S-g)?m=x+i.shift():g=S+i.shift(),r.U.P.curveTo(n,D,v,_,k,Y,K),r.U.P.curveTo(n,U,w,x,S,m,g));else if(b=="o14"){if(i.length>0&&!l&&(c=i.shift()+o.nominalWidthX,l=!0),i.length==4){var ie=i.shift(),P=i.shift(),W=i.shift(),p=i.shift(),T=r.CFF.glyphBySE(o,W),L=r.CFF.glyphBySE(o,p);r.U._drawCFF(o.CharStrings[T],e,o,a,n),e.x=ie,e.y=P,r.U._drawCFF(o.CharStrings[L],e,o,a,n)}h&&(r.U.P.closePath(n),h=!1)}else if(b=="o19"||b=="o20")i.length%2!=0&&!l&&(c=i.shift()+a.nominalWidthX),s+=i.length>>1,i.length=0,l=!0,y+=s+7>>3;else if(b=="o21")i.length>2&&!l&&(c=i.shift()+a.nominalWidthX,l=!0),g+=i.pop(),m+=i.pop(),h&&r.U.P.closePath(n),r.U.P.moveTo(n,m,g),h=!0;else if(b=="o22")i.length>1&&!l&&(c=i.shift()+a.nominalWidthX,l=!0),m+=i.pop(),h&&r.U.P.closePath(n),r.U.P.moveTo(n,m,g),h=!0;else if(b=="o25"){for(;i.length>6;)m+=i.shift(),g+=i.shift(),r.U.P.lineTo(n,m,g);D=m+i.shift(),v=g+i.shift(),_=D+i.shift(),k=v+i.shift(),m=_+i.shift(),g=k+i.shift(),r.U.P.curveTo(n,D,v,_,k,m,g)}else if(b=="o26")for(i.length%2&&(m+=i.shift());i.length>0;)D=m,v=g+i.shift(),m=_=D+i.shift(),g=(k=v+i.shift())+i.shift(),r.U.P.curveTo(n,D,v,_,k,m,g);else if(b=="o27")for(i.length%2&&(g+=i.shift());i.length>0;)v=g,_=(D=m+i.shift())+i.shift(),k=v+i.shift(),m=_+i.shift(),g=k,r.U.P.curveTo(n,D,v,_,k,m,g);else if(b=="o10"||b=="o29"){var O=b=="o10"?a:o;if(i.length==0)console.debug("error: empty stack");else{var C=i.pop(),I=O.Subrs[C+O.Bias];e.x=m,e.y=g,e.nStems=s,e.haveWidth=l,e.width=c,e.open=h,r.U._drawCFF(I,e,o,a,n),m=e.x,g=e.y,s=e.nStems,l=e.haveWidth,c=e.width,h=e.open}}else if(b=="o30"||b=="o31"){var F=i.length,M=(se=0,b=="o31");for(se+=F-(R=-3&F);se<R;)M?(v=g,_=(D=m+i.shift())+i.shift(),g=(k=v+i.shift())+i.shift(),R-se==5?(m=_+i.shift(),se++):m=_,M=!1):(D=m,v=g+i.shift(),_=D+i.shift(),k=v+i.shift(),m=_+i.shift(),R-se==5?(g=k+i.shift(),se++):g=k,M=!0),r.U.P.curveTo(n,D,v,_,k,m,g),se+=4}else{if((b+"").charAt(0)=="o")throw console.debug("Unknown operation: "+b,t),b;i.push(b)}}}e.x=m,e.y=g,e.nStems=s,e.haveWidth=l,e.width=c,e.open=h};var d=r,f={Typr:d};return u.Typr=d,u.default=f,Object.defineProperty(u,"__esModule",{value:!0}),u}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function Wa(){return function(u){var r=Uint8Array,d=Uint16Array,f=Uint32Array,t=new r([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e=new r([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new r([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(b,R){for(var E=new d(31),j=0;j<31;++j)E[j]=R+=1<<b[j-1];var N=new f(E[30]);for(j=1;j<30;++j)for(var se=E[j];se<E[j+1];++se)N[se]=se-E[j]<<5|j;return[E,N]},n=a(t,2),i=n[0],s=n[1];i[28]=258,s[258]=28;for(var l=a(e,0)[0],c=new d(32768),h=0;h<32768;++h){var y=(43690&h)>>>1|(21845&h)<<1;y=(61680&(y=(52428&y)>>>2|(13107&y)<<2))>>>4|(3855&y)<<4,c[h]=((65280&y)>>>8|(255&y)<<8)>>>1}var m=function(b,R,E){for(var j=b.length,N=0,se=new d(R);N<j;++N)++se[b[N]-1];var ie,P=new d(R);for(N=0;N<R;++N)P[N]=P[N-1]+se[N-1]<<1;if(E){ie=new d(1<<R);var W=15-R;for(N=0;N<j;++N)if(b[N])for(var p=N<<4|b[N],T=R-b[N],L=P[b[N]-1]++<<T,O=L|(1<<T)-1;L<=O;++L)ie[c[L]>>>W]=p}else for(ie=new d(j),N=0;N<j;++N)b[N]&&(ie[N]=c[P[b[N]-1]++]>>>15-b[N]);return ie},g=new r(288);for(h=0;h<144;++h)g[h]=8;for(h=144;h<256;++h)g[h]=9;for(h=256;h<280;++h)g[h]=7;for(h=280;h<288;++h)g[h]=8;var D=new r(32);for(h=0;h<32;++h)D[h]=5;var v=m(g,9,1),_=m(D,5,1),k=function(b){for(var R=b[0],E=1;E<b.length;++E)b[E]>R&&(R=b[E]);return R},U=function(b,R,E){var j=R/8|0;return(b[j]|b[j+1]<<8)>>(7&R)&E},w=function(b,R){var E=R/8|0;return(b[E]|b[E+1]<<8|b[E+2]<<16)>>(7&R)},x=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],S=function(b,R,E){var j=new Error(R||x[b]);if(j.code=b,Error.captureStackTrace&&Error.captureStackTrace(j,S),!E)throw j;return j},Y=function(b,R,E){var j=b.length;if(!j||E&&!E.l&&j<5)return R||new r(0);var N=!R||E,se=!E||E.i;E||(E={}),R||(R=new r(3*j));var ie,P=function(oe){var ye=R.length;if(oe>ye){var Ue=new r(Math.max(2*ye,oe));Ue.set(R),R=Ue}},W=E.f||0,p=E.p||0,T=E.b||0,L=E.l,O=E.d,C=E.m,I=E.n,F=8*j;do{if(!L){E.f=W=U(b,p,1);var M=U(b,p+1,3);if(p+=3,!M){var z=b[(H=((ie=p)/8|0)+(7&ie&&1)+4)-4]|b[H-3]<<8,q=H+z;if(q>j){se&&S(0);break}N&&P(T+z),R.set(b.subarray(H,q),T),E.b=T+=z,E.p=p=8*q;continue}if(M==1)L=v,O=_,C=9,I=5;else if(M==2){var V=U(b,p,31)+257,A=U(b,p+10,15)+4,he=V+U(b,p+5,31)+1;p+=14;for(var ce=new r(he),X=new r(19),$=0;$<A;++$)X[o[$]]=U(b,p+3*$,7);p+=3*A;var le=k(X),B=(1<<le)-1,te=m(X,le,1);for($=0;$<he;){var H,G=te[U(b,p,B)];if(p+=15&G,(H=G>>>4)<16)ce[$++]=H;else{var ae=0,Q=0;for(H==16?(Q=3+U(b,p,3),p+=2,ae=ce[$-1]):H==17?(Q=3+U(b,p,7),p+=3):H==18&&(Q=11+U(b,p,127),p+=7);Q--;)ce[$++]=ae}}var re=ce.subarray(0,V),J=ce.subarray(V);C=k(re),I=k(J),L=m(re,C,1),O=m(J,I,1)}else S(1);if(p>F){se&&S(0);break}}N&&P(T+131072);for(var me=(1<<C)-1,pe=(1<<I)-1,ee=p;;ee=p){var ue=(ae=L[w(b,p)&me])>>>4;if((p+=15&ae)>F){se&&S(0);break}if(ae||S(2),ue<256)R[T++]=ue;else{if(ue==256){ee=p,L=null;break}var ge=ue-254;if(ue>264){var Fe=t[$=ue-257];ge=U(b,p,(1<<Fe)-1)+i[$],p+=Fe}var fe=O[w(b,p)&pe],Se=fe>>>4;if(fe||S(3),p+=15&fe,J=l[Se],Se>3&&(Fe=e[Se],J+=w(b,p)&(1<<Fe)-1,p+=Fe),p>F){se&&S(0);break}N&&P(T+131072);for(var ve=T+ge;T<ve;T+=4)R[T]=R[T-J],R[T+1]=R[T+1-J],R[T+2]=R[T+2-J],R[T+3]=R[T+3-J];T=ve}}E.l=L,E.p=ee,E.b=T,L&&(W=1,E.m=C,E.d=O,E.n=I)}while(!W);return T==R.length?R:function(oe,ye,Ue){(ye==null||ye<0)&&(ye=0),(Ue==null||Ue>oe.length)&&(Ue=oe.length);var De=new(oe instanceof d?d:oe instanceof f?f:r)(Ue-ye);return De.set(oe.subarray(ye,Ue)),De}(R,0,T)},K=new r(0),ne=typeof TextDecoder<"u"&&new TextDecoder;try{ne.decode(K,{stream:!0})}catch{}return u.convert_streams=function(b){var R=new DataView(b),E=0;function j(){var V=R.getUint16(E);return E+=2,V}function N(){var V=R.getUint32(E);return E+=4,V}function se(V){z.setUint16(q,V),q+=2}function ie(V){z.setUint32(q,V),q+=4}for(var P={signature:N(),flavor:N(),length:N(),numTables:j(),reserved:j(),totalSfntSize:N(),majorVersion:j(),minorVersion:j(),metaOffset:N(),metaLength:N(),metaOrigLength:N(),privOffset:N(),privLength:N()},W=0;Math.pow(2,W)<=P.numTables;)W++;W--;for(var p=16*Math.pow(2,W),T=16*P.numTables-p,L=12,O=[],C=0;C<P.numTables;C++)O.push({tag:N(),offset:N(),compLength:N(),origLength:N(),origChecksum:N()}),L+=16;var I,F=new Uint8Array(12+16*O.length+O.reduce(function(V,A){return V+A.origLength+4},0)),M=F.buffer,z=new DataView(M),q=0;return ie(P.flavor),se(P.numTables),se(p),se(W),se(T),O.forEach(function(V){ie(V.tag),ie(V.origChecksum),ie(L),ie(V.origLength),V.outOffset=L,(L+=V.origLength)%4!=0&&(L+=4-L%4)}),O.forEach(function(V){var A,he=b.slice(V.offset,V.offset+V.compLength);if(V.compLength!=V.origLength){var ce=new Uint8Array(V.origLength);A=new Uint8Array(he,2),Y(A,ce)}else ce=new Uint8Array(he);F.set(ce,V.outOffset);var X=0;(L=V.outOffset+V.origLength)%4!=0&&(X=4-L%4),F.set(new Uint8Array(X).buffer,V.outOffset+V.origLength),I=L+X}),M.slice(0,I)},Object.defineProperty(u,"__esModule",{value:!0}),u}({}).convert_streams}function Na(u,r){const d={M:2,L:2,Q:4,C:6,Z:0},f={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},t=1,e=2,o=4,a=8,n=16,i=32;let s;function l(U){if(!s){const w={R:e,L:t,D:o,C:n,U:i,T:a};s=new Map;for(let x in f){let S=0;f[x].split(",").forEach(Y=>{let[K,ne]=Y.split("+");K=parseInt(K,36),ne=ne?parseInt(ne,36):0,s.set(S+=K,w[x]);for(let b=ne;b--;)s.set(++S,w[x])})}}return s.get(U)||i}const c=1,h=2,y=3,m=4,g=[null,"isol","init","fina","medi"];function D(U){const w=new Uint8Array(U.length);let x=i,S=c,Y=-1;for(let K=0;K<U.length;K++){const ne=U.codePointAt(K);let b=l(ne)|0,R=c;b&a||(x&(t|o|n)?b&(e|o|n)?(R=y,(S===c||S===y)&&w[Y]++):b&(t|i)&&(S===h||S===m)&&w[Y]--:x&(e|i)&&(S===h||S===m)&&w[Y]--,S=w[K]=R,x=b,Y=K,ne>65535&&K++)}return w}function v(U,w){const x=[];for(let Y=0;Y<w.length;Y++){const K=w.codePointAt(Y);K>65535&&Y++,x.push(u.U.codeToGlyph(U,K))}const S=U.GSUB;if(S){const{lookupList:Y,featureList:K}=S;let ne;const b=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,R=[];K.forEach(E=>{if(b.test(E.tag))for(let j=0;j<E.tab.length;j++){if(R[E.tab[j]])continue;R[E.tab[j]]=!0;const N=Y[E.tab[j]],se=/^(isol|init|fina|medi)$/.test(E.tag);se&&!ne&&(ne=D(w));for(let ie=0;ie<x.length;ie++)(!ne||!se||g[ne[ie]]===E.tag)&&u.U._applySubs(x,ie,N,Y)}})}return x}function _(...U){for(let w=0;w<U.length;w++)if(typeof U[w]=="number")return U[w]}function k(U){const w=Object.create(null),x=U["OS/2"],S=U.hhea,Y=U.head.unitsPerEm,K=_(x&&x.sTypoAscender,S&&S.ascender,Y),ne={unitsPerEm:Y,ascender:K,descender:_(x&&x.sTypoDescender,S&&S.descender,0),capHeight:_(x&&x.sCapHeight,K),xHeight:_(x&&x.sxHeight,K),lineGap:_(x&&x.sTypoLineGap,S&&S.lineGap),forEachGlyph(b,R,E,j){let N=0;const se=1/ne.unitsPerEm*R,ie=v(U,b);let P=0,W=-1;return ie.forEach((p,T)=>{if(p!==-1){let L=w[p];if(!L){const{cmds:O,crds:C}=u.U.glyphToPath(U,p);let I="",F=0;for(let A=0,he=O.length;A<he;A++){const ce=d[O[A]];I+=O[A];for(let X=1;X<=ce;X++)I+=(X>1?",":"")+C[F++]}let M,z,q,V;if(C.length){M=z=1/0,q=V=-1/0;for(let A=0,he=C.length;A<he;A+=2){let ce=C[A],X=C[A+1];ce<M&&(M=ce),X<z&&(z=X),ce>q&&(q=ce),X>V&&(V=X)}}else M=q=z=V=0;L=w[p]={index:p,advanceWidth:U.hmtx.aWidth[p],xMin:M,yMin:z,xMax:q,yMax:V,path:I,pathCommandCount:O.length}}W!==-1&&(N+=u.U.getPairAdjustment(U,W,p)*se),j.call(null,L,N,P),L.advanceWidth&&(N+=L.advanceWidth*se),E&&(N+=E*R),W=p}P+=b.codePointAt(P)>65535?2:1}),N}};return ne}return function(w){const x=new Uint8Array(w,0,4),S=u._bin.readASCII(x,0,4);if(S==="wOFF")w=r(w);else if(S==="wOF2")throw new Error("woff2 fonts not supported");return k(u.parse(w)[0])}}const za=Dt({name:"Typr Font Parser",dependencies:[Ia,Wa,Na],init(u,r,d){const f=u(),t=r();return d(f,t)}}),lt={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},Va=new Er;function st(){return(self.performance||Date).now()}const cn=Object.create(null);function kn(u,r){u=Ya({},u);const d=st();if(u.font=Ha(u.font||lt.defaultFontURL),u.text=""+u.text,u.sdfGlyphSize=u.sdfGlyphSize||lt.sdfGlyphSize,u.colorRanges!=null){let l={};for(let c in u.colorRanges)if(u.colorRanges.hasOwnProperty(c)){let h=u.colorRanges[c];typeof h!="number"&&(h=Va.set(h).getHex()),l[c]=h}u.colorRanges=l}Object.freeze(u);const{textureWidth:f,sdfExponent:t}=lt,{sdfGlyphSize:e}=u,o=f/e*4;let a=cn[e];if(!a){const l=document.createElement("canvas");l.width=f,l.height=e*256/o,a=cn[e]={glyphCount:0,sdfGlyphSize:e,sdfCanvas:l,sdfTexture:new Jn(l,void 0,void 0,void 0,en,en),contextLost:!1,glyphsByFont:new Map},a.sdfTexture.generateMipmaps=!1,ja(a)}const{sdfTexture:n,sdfCanvas:i}=a;let s=a.glyphsByFont.get(u.font);s||a.glyphsByFont.set(u.font,s=new Map),Ka(u).then(l=>{const{glyphIds:c,glyphPositions:h,fontSize:y,unitsPerEm:m,timings:g}=l,D=[],v=new Float32Array(c.length*4),_=y/m;let k=0,U=0;const w=st();c.forEach((ne,b)=>{let R=s.get(ne);if(!R){const{path:se,pathBounds:ie}=l.glyphData[ne],P=Math.max(ie[2]-ie[0],ie[3]-ie[1])/e*(lt.sdfMargin*e+.5),W=a.glyphCount++,p=[ie[0]-P,ie[1]-P,ie[2]+P,ie[3]+P];s.set(ne,R={path:se,atlasIndex:W,sdfViewBox:p}),D.push(R)}const{sdfViewBox:E}=R,j=h[U++],N=h[U++];v[k++]=j+E[0]*_,v[k++]=N+E[1]*_,v[k++]=j+E[2]*_,v[k++]=N+E[3]*_,c[b]=R.atlasIndex}),g.quads=(g.quads||0)+(st()-w);const x=st();g.sdf={};const S=i.height,Y=Math.ceil(a.glyphCount/o),K=Math.pow(2,Math.ceil(Math.log2(Y*e)));K>S&&(console.info(`Increasing SDF texture size ${S}->${K}`),Ra(i,f,K),n.dispose()),Promise.all(D.map(ne=>Fn(ne,a,u.gpuAccelerateSDF).then(({timing:b})=>{g.sdf[ne.atlasIndex]=b}))).then(()=>{D.length&&!a.contextLost&&(Dn(a),n.needsUpdate=!0),g.sdfTotal=st()-x,g.total=st()-d,r(Object.freeze({parameters:u,sdfTexture:n,sdfGlyphSize:e,sdfExponent:t,glyphBounds:v,glyphAtlasIndices:c,glyphColors:l.glyphColors,caretPositions:l.caretPositions,caretHeight:l.caretHeight,chunkedBounds:l.chunkedBounds,ascender:l.ascender,descender:l.descender,lineHeight:l.lineHeight,capHeight:l.capHeight,xHeight:l.xHeight,topBaseline:l.topBaseline,blockBounds:l.blockBounds,visibleBounds:l.visibleBounds,timings:l.timings}))})}),Promise.resolve().then(()=>{a.contextLost||Ba(i)})}function Fn({path:u,atlasIndex:r,sdfViewBox:d},{sdfGlyphSize:f,sdfCanvas:t,contextLost:e},o){if(e)return Promise.resolve({timing:-1});const{textureWidth:a,sdfExponent:n}=lt,i=Math.max(d[2]-d[0],d[3]-d[1]),s=Math.floor(r/4),l=s%(a/f)*f,c=Math.floor(s/(a/f))*f,h=r%4;return Aa(f,f,u,d,i,n,t,l,c,h,o)}function ja(u){const r=u.sdfCanvas;r.addEventListener("webglcontextlost",d=>{console.log("Context Lost",d),d.preventDefault(),u.contextLost=!0}),r.addEventListener("webglcontextrestored",d=>{console.log("Context Restored",d),u.contextLost=!1;const f=[];u.glyphsByFont.forEach(t=>{t.forEach(e=>{f.push(Fn(e,u,!0))})}),Promise.all(f).then(()=>{Dn(u),u.sdfTexture.needsUpdate=!0})})}function Xa({font:u,characters:r,sdfGlyphSize:d},f){let t=Array.isArray(r)?r.join(`
`):""+r;kn({font:u,sdfGlyphSize:d,text:t},f)}function Ya(u,r){for(let d in r)r.hasOwnProperty(d)&&(u[d]=r[d]);return u}let Yt;function Ha(u){return Yt||(Yt=typeof document>"u"?{}:document.createElement("a")),Yt.href=u,Yt.href}function Dn(u){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:r,sdfTexture:d}=u,{width:f,height:t}=r,e=u.sdfCanvas.getContext("webgl");let o=d.image.data;(!o||o.length!==f*t*4)&&(o=new Uint8Array(f*t*4),d.image={width:f,height:t,data:o},d.flipY=!1,d.isDataTexture=!0),e.readPixels(0,0,f,t,e.RGBA,e.UNSIGNED_BYTE,o)}}const Ja=Dt({name:"Typesetter",dependencies:[lt,za,Ea,Sa],init(u,r,d,f){const{defaultFontURL:t}=u;return d(r,f(),{defaultFontURL:t})}}),Ka=Dt({name:"Typesetter",dependencies:[Ja],init(u){return function(r){return new Promise(d=>{u.typeset(r,d)})}},getTransferables(u){const r=[u.glyphPositions.buffer,u.glyphIds.buffer];return u.caretPositions&&r.push(u.caretPositions.buffer),u.glyphColors&&r.push(u.glyphColors.buffer),r}}),dn={};function Qa(u){let r=dn[u];if(!r){const d=new Mr(1,1,u,u),f=d.clone(),t=d.attributes,e=f.attributes,o=new na,a=t.uv.count;for(let n=0;n<a;n++)e.position.array[n*3]*=-1,e.normal.array[n*3+2]*=-1;["position","normal","uv"].forEach(n=>{o.setAttribute(n,new aa([...t[n].array,...e[n].array],t[n].itemSize))}),o.setIndex([...d.index.array,...f.index.array.map(n=>n+a)]),o.translate(.5,.5,0),r=dn[u]=o}return r}const Za="aTroikaGlyphBounds",hn="aTroikaGlyphIndex",qa="aTroikaGlyphColor";class $a extends Kn{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Qn,this.boundingBox=new Zn}computeBoundingSphere(){}computeBoundingBox(){}setSide(r){const d=this.getIndex().count;this.setDrawRange(r===qn?d/2:0,r===_n?d:d/2)}set detail(r){if(r!==this._detail){this._detail=r,(typeof r!="number"||r<1)&&(r=1);let d=Qa(r);["position","normal","uv"].forEach(f=>{this.attributes[f]=d.attributes[f].clone()}),this.setIndex(d.getIndex().clone())}}get detail(){return this._detail}set curveRadius(r){r!==this._curveRadius&&(this._curveRadius=r,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(r,d,f,t,e){_r(this,Za,r,4),_r(this,hn,d,1),_r(this,qa,e,3),this._blockBounds=f,this._chunkedBounds=t,this.instanceCount=d.length,this._updateBounds()}_updateBounds(){const r=this._blockBounds;if(r){const{curveRadius:d,boundingBox:f}=this;if(d){const{PI:t,floor:e,min:o,max:a,sin:n,cos:i}=Math,s=t/2,l=t*2,c=Math.abs(d),h=r[0]/c,y=r[2]/c,m=e((h+s)/l)!==e((y+s)/l)?-c:o(n(h)*c,n(y)*c),g=e((h-s)/l)!==e((y-s)/l)?c:a(n(h)*c,n(y)*c),D=e((h+t)/l)!==e((y+t)/l)?c*2:a(c-i(h)*c,c-i(y)*c);f.min.set(m,r[1],d<0?-D:0),f.max.set(g,r[3],d<0?0:D)}else f.min.set(r[0],r[1],0),f.max.set(r[2],r[3],0);f.getBoundingSphere(this.boundingSphere)}}applyClipRect(r){let d=this.getAttribute(hn).count,f=this._chunkedBounds;if(f)for(let t=f.length;t--;){d=f[t].end;let e=f[t].rect;if(e[1]<r.w&&e[3]>r.y&&e[0]<r.z&&e[2]>r.x)break}this.instanceCount=d}}function _r(u,r,d,f){const t=u.getAttribute(r);d?t&&t.array.length===d.length?(t.array.set(d),t.needsUpdate=!0):(u.setAttribute(r,new $n(d,f)),delete u._maxInstanceCount,u.dispose()):t&&u.deleteAttribute(r)}const eo=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,to=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,ro=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,no=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function ao(u){const r=kr(u,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Zt},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new tn(0,0,0,0)},uTroikaClipRect:{value:new tn(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Zt},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Er},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new ea},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:eo,vertexTransform:to,fragmentDefs:ro,fragmentColorTransform:no,customRewriter({vertexShader:d,fragmentShader:f}){let t=/\buniform\s+vec3\s+diffuse\b/;return t.test(f)&&(f=f.replace(t,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),t.test(d)||(d=d.replace(Tn,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:d,fragmentShader:f}}});return r.transparent=!0,Object.defineProperties(r,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),r}const Pr=new ta({color:16777215,side:_n,transparent:!0}),vn=8421504,pn=new ra,Ht=new Ar,Sr=new Ar,Tt=[],oo=new Ar,wr="+x+y";function gn(u){return Array.isArray(u)?u[0]:u}let Cn=()=>{const u=new Cr(new Mr(1,1),Pr);return Cn=()=>u,u},En=()=>{const u=new Cr(new Mr(1,1,32,1),Pr);return En=()=>u,u};const io={type:"syncstart"},so={type:"synccomplete"},An=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],lo=An.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let Mn=class extends Cr{constructor(){const r=new $a;super(r,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=vn,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=wr,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(r){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(r):(this._isSyncing=!0,this.dispatchEvent(io),kn({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF},d=>{this._isSyncing=!1,this._textRenderInfo=d,this.geometry.updateGlyphs(d.glyphBounds,d.glyphAtlasIndices,d.blockBounds,d.chunkedBounds,d.glyphColors);const f=this._queuedSyncs;f&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{f.forEach(t=>t&&t())})),this.dispatchEvent(so),r&&r()})))}onBeforeRender(r,d,f,t,e,o){this.sync(),e.isTroikaTextMaterial&&this._prepareForRender(e),e._hadOwnSide=e.hasOwnProperty("side"),this.geometry.setSide(e._actualSide=e.side),e.side=Hn}onAfterRender(r,d,f,t,e,o){e._hadOwnSide?e.side=e._actualSide:delete e.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let r=this._derivedMaterial;const d=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=Pr.clone());if((!r||r.baseMaterial!==d)&&(r=this._derivedMaterial=ao(d),d.addEventListener("dispose",function f(){d.removeEventListener("dispose",f),r.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let f=r._outlineMtl;return f||(f=r._outlineMtl=Object.create(r,{id:{value:r.id+.1}}),f.isTextOutlineMaterial=!0,f.depthWrite=!1,f.map=null,r.addEventListener("dispose",function t(){r.removeEventListener("dispose",t),f.dispose()})),[f,r]}else return r}set material(r){r&&r.isTroikaTextMaterial?(this._derivedMaterial=r,this._baseMaterial=r.baseMaterial):this._baseMaterial=r}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(r){this.geometry.detail=r}get curveRadius(){return this.geometry.curveRadius}set curveRadius(r){this.geometry.curveRadius=r}get customDepthMaterial(){return gn(this.material).getDepthMaterial()}get customDistanceMaterial(){return gn(this.material).getDistanceMaterial()}_prepareForRender(r){const d=r.isTextOutlineMaterial,f=r.uniforms,t=this.textRenderInfo;if(t){const{sdfTexture:a,blockBounds:n}=t;f.uTroikaSDFTexture.value=a,f.uTroikaSDFTextureSize.value.set(a.image.width,a.image.height),f.uTroikaSDFGlyphSize.value=t.sdfGlyphSize,f.uTroikaSDFExponent.value=t.sdfExponent,f.uTroikaTotalBounds.value.fromArray(n),f.uTroikaUseGlyphColors.value=!d&&!!t.glyphColors;let i=0,s=0,l=0,c,h,y,m=0,g=0;if(d){let{outlineWidth:v,outlineOffsetX:_,outlineOffsetY:k,outlineBlur:U,outlineOpacity:w}=this;i=this._parsePercent(v)||0,s=Math.max(0,this._parsePercent(U)||0),c=w,m=this._parsePercent(_)||0,g=this._parsePercent(k)||0}else l=Math.max(0,this._parsePercent(this.strokeWidth)||0),l&&(y=this.strokeColor,f.uTroikaStrokeColor.value.set(y??vn),h=this.strokeOpacity,h==null&&(h=1)),c=this.fillOpacity;f.uTroikaDistanceOffset.value=i,f.uTroikaPositionOffset.value.set(m,g),f.uTroikaBlurRadius.value=s,f.uTroikaStrokeWidth.value=l,f.uTroikaStrokeOpacity.value=h,f.uTroikaFillOpacity.value=c??1,f.uTroikaCurveRadius.value=this.curveRadius||0;let D=this.clipRect;if(D&&Array.isArray(D)&&D.length===4)f.uTroikaClipRect.value.fromArray(D);else{const v=(this.fontSize||.1)*100;f.uTroikaClipRect.value.set(n[0]-v,n[1]-v,n[2]+v,n[3]+v)}this.geometry.applyClipRect(f.uTroikaClipRect.value)}f.uTroikaSDFDebug.value=!!this.debugSDF,r.polygonOffset=!!this.depthOffset,r.polygonOffsetFactor=r.polygonOffsetUnits=this.depthOffset||0;const e=d?this.outlineColor||0:this.color;if(e==null)delete r.color;else{const a=r.hasOwnProperty("color")?r.color:r.color=new Er;(e!==a._input||typeof e=="object")&&a.set(a._input=e)}let o=this.orientation||wr;if(o!==r._orientation){let a=f.uTroikaOrient.value;o=o.replace(/[^-+xyz]/g,"");let n=o!==wr&&o.match(/^([-+])([xyz])([-+])([xyz])$/);if(n){let[,i,s,l,c]=n;Ht.set(0,0,0)[s]=i==="-"?1:-1,Sr.set(0,0,0)[c]=l==="-"?-1:1,pn.lookAt(oo,Ht.cross(Sr),Sr),a.setFromMatrix4(pn)}else a.identity();r._orientation=o}}_parsePercent(r){if(typeof r=="string"){let d=r.match(/^(-?[\d.]+)%$/),f=d?parseFloat(d[1]):NaN;r=(isNaN(f)?0:f/100)*this.fontSize}return r}localPositionToTextCoords(r,d=new Zt){d.copy(r);const f=this.curveRadius;return f&&(d.x=Math.atan2(r.x,Math.abs(f)-Math.abs(r.z))*Math.abs(f)),d}worldPositionToTextCoords(r,d=new Zt){return Ht.copy(r),this.localPositionToTextCoords(this.worldToLocal(Ht),d)}raycast(r,d){const{textRenderInfo:f,curveRadius:t}=this;if(f){const e=f.blockBounds,o=t?En():Cn(),a=o.geometry,{position:n,uv:i}=a.attributes;for(let s=0;s<i.count;s++){let l=e[0]+i.getX(s)*(e[2]-e[0]);const c=e[1]+i.getY(s)*(e[3]-e[1]);let h=0;t&&(h=t-Math.cos(l/t)*t,l=Math.sin(l/t)*t),n.setXYZ(s,l,c,h)}a.boundingSphere=this.geometry.boundingSphere,a.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,Tt.length=0,o.raycast(r,Tt);for(let s=0;s<Tt.length;s++)Tt[s].object=this,d.push(Tt[s])}}copy(r){const d=this.geometry;return super.copy(r),this.geometry=d,lo.forEach(f=>{this[f]=r[f]}),this}clone(){return new this.constructor().copy(this)}};An.forEach(u=>{const r="_private_"+u;Object.defineProperty(Mn.prototype,u,{get(){return this[r]},set(d){d!==this[r]&&(this[r]=d,this._needsSync=!0)}})});const Pn=Ye.forwardRef(({sdfGlyphSize:u=64,anchorX:r="center",anchorY:d="middle",font:f,fontSize:t=1,children:e,characters:o,onSync:a,...n},i)=>{const s=oa(({invalidate:y})=>y),[l]=Ye.useState(()=>new Mn),[c,h]=Ye.useMemo(()=>{const y=[];let m="";return Ye.Children.forEach(e,g=>{typeof g=="string"||typeof g=="number"?m+=g:y.push(g)}),[y,m]},[e]);return pa(()=>new Promise(y=>Xa({font:f,characters:o},y)),["troika-text",f,o]),Ye.useLayoutEffect(()=>void l.sync(()=>{s(),a&&a(l)})),Ye.useEffect(()=>()=>l.dispose(),[l]),Ye.createElement("primitive",ca({object:l,ref:i,font:f,text:h,anchorX:r,anchorY:d,fontSize:t,sdfGlyphSize:u},n),c)}),Eo={title:"React / Pong"},tt=new Nn({components:["object3D","position","velocity","player","ai","ball","paddle","input","score"]});tt.init();const{Entity:tr,Component:Gn,Entities:fo}=ia(tt),ft={paddles:tt.query(u=>u.has("paddle","input","position","velocity")),ai:tt.query(u=>u.has("ai","paddle","position","input")),balls:tt.query(u=>u.has("ball","position","velocity")),score:tt.query(u=>u.has("score"))},Gr=15,Dr=Gr/2,qt=-Gr/2,Ft=20,mn=4,uo=()=>{for(const u of ft.ai){const{input:r}=u,[d,f]=u.position,e=[...ft.balls.entities].sort((a,n)=>{const{position:i,velocity:s}=a,{position:l,velocity:c}=n,h=s[0]>0&&i[0]<d||s[0]<0&&i[0]>d,y=c[0]>0&&l[0]<d||c[0]<0&&l[0]>d;if(h===y){const m=Math.abs(i[0]-d),g=Math.abs(l[0]-d);return m-g}else return h?-1:1})[0].position[1],o=.5;e>f+o?(r.up=!0,r.down=!1):e<f-o?(r.up=!1,r.down=!0):(r.up=!1,r.down=!1)}},co=u=>{for(const r of ft.paddles){const{position:d,velocity:f,input:t,paddle:e}=r;t.up?f[1]=e.speed*u:t.down?f[1]=-e.speed*u:f[1]=0;let o=0;t.up?o=1:t.down&&(o=-1),o*=5*e.speed*u,f[1]=o,d[1]+=f[1],d[1]=Math.min(d[1],Dr-e.height/2),d[1]=Math.max(d[1],qt+e.height/2)}},ho=u=>{for(const r of ft.balls){const{position:d,velocity:f,ball:t}=r,e=Math.sqrt(f[0]**2+f[1]**2);let o=f[0]/=e,a=f[1]/=e;o*=t.speed,a*=t.speed,d[0]+=o*u,d[1]+=a*u,d[1]>Dr-t.size/2?(f[1]*=-1,d[1]=Dr-t.size/2):d[1]<qt+t.size/2&&(f[1]*=-1,d[1]=qt+t.size/2);for(const i of ft.paddles){const{position:s,paddle:l}=i;d[0]-t.size/2<=s[0]+l.width/2&&d[0]+t.size/2>=s[0]-l.width/2&&d[1]-t.size/2<=s[1]+l.height/2&&d[1]+t.size/2>=s[1]-l.height/2&&(f[0]*=-1,d[0]=s[0]+Math.sign(f[0])*(l.width/2+t.size/2),f[1]=(d[1]-s[1])/t.size/2,t.speed<20&&(t.speed*=1.2))}const{score:n}=ft.score.first;d[0]<-Ft/2?(n.set(i=>({...i,right:i.right+1})),t.speed=mn,d[0]=0,d[1]=0,f[0]=-1,f[1]=-1):d[0]>Ft/2&&(n.set(i=>({...i,left:i.left+1})),t.speed=mn,d[0]=0,d[1]=0,f[0]=1,f[1]=1)}},vo=()=>{for(const u of tt.entities){const{object3D:r,position:d}=u;r&&d&&r.position.set(d[0],d[1],0)}},po=()=>{const u=Ye.useMemo(()=>({up:!1,down:!1}),[]);return Ye.useEffect(()=>{const r=["ArrowUp","w"],d=["ArrowDown","s"],f=e=>{r.includes(e.key)?u.up=!0:d.includes(e.key)&&(u.down=!0)},t=e=>{r.includes(e.key)?u.up=!1:d.includes(e.key)&&(u.down=!1)};return document.addEventListener("keydown",f),document.addEventListener("keyup",t),()=>{document.removeEventListener("keydown",f),document.removeEventListener("keyup",t)}},[]),_e(tr,{player:!0,paddle:{height:3,width:1,speed:1},position:[-Ft/2,0],velocity:[0,0],input:u})},go=()=>_e(tr,{ai:!0,paddle:{height:3,width:1,speed:1},position:[Ft/2,0],velocity:[0,0],input:{up:!1,down:!1}}),mo=()=>_e($t,{children:[{velocity:[-1,-1]},{velocity:[1,1]}].map(({velocity:r},d)=>_e(tr,{ball:{size:1,speed:5},position:[0,0],velocity:r,children:_e(Gn,{name:"object3D",children:ut("mesh",{children:[_e("boxGeometry",{args:[1,1,1]}),_e("meshNormalMaterial",{})]})})},d))}),yo=()=>_e(fo,{where:u=>u.has("paddle"),children:u=>_e(Gn,{name:"object3D",children:ut("mesh",{children:[_e("boxGeometry",{args:[u.paddle.width,u.paddle.height,1]}),_e("meshNormalMaterial",{})]})})}),bo=()=>ut("mesh",{"position-z":-.5,children:[_e("planeGeometry",{args:[Ft,Gr]}),_e("meshBasicMaterial",{color:"#333"})]}),Uo=()=>{const[u,r]=Ye.useState(()=>({left:0,right:0}));return ut($t,{children:[_e(tr,{score:{value:u,set:r}}),ut(Pn,{position:[0,0,-.45],color:"#999",fontSize:5,children:[u.left," - ",u.right]})]})},_o=()=>(sa((u,r)=>{uo(),co(r),ho(r),vo()}),ut($t,{children:[_e(po,{}),_e(go,{}),_e(mo,{}),_e(yo,{}),_e(Uo,{}),_e(fa,{fit:!0,observe:!0,margin:1.2,children:_e(bo,{})}),_e(Pn,{position:[0,qt-1,.5],color:"#fff",fontSize:.8,children:"Use the up and down arrow keys or W and S to move!"}),_e(ua,{makeDefault:!0,position:[0,0,20]})]})),Jt=()=>_e($t,{children:_e(la,{controls:!1,lights:!1,children:_e(_o,{})})});var yn,bn,Un;Jt.parameters={...Jt.parameters,docs:{...(yn=Jt.parameters)==null?void 0:yn.docs,source:{originalSource:`() => {
  return <>
      <Setup controls={false} lights={false}>
        <App />
      </Setup>
    </>;
}`,...(Un=(bn=Jt.parameters)==null?void 0:bn.docs)==null?void 0:Un.source}}};const Ao=["Pong"];export{Jt as Pong,Ao as __namedExportsOrder,Eo as default};
